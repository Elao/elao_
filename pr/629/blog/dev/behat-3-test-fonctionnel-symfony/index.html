<!DOCTYPE html>
<html lang="fr" class="no-js">
    <head>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>Behat 3 pour vos tests fonctionnels Symfony2</title>

        <!-- Favicon -->
        <link rel="apple-touch-icon" sizes="180x180" href="/elao_/pr/629/apple-touch-icon.png">
        <link rel="icon" type="image/png" sizes="32x32" href="/elao_/pr/629/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/elao_/pr/629/favicon-16x16.png">
        <link rel="manifest" href="/elao_/pr/629/site.webmanifest">
        <link rel="mask-icon" href="/elao_/pr/629/safari-pinned-tab.svg" color="#ff4344">
        <link rel="shortcut icon" href="/elao_/pr/629/favicon.ico">
        <meta name="msapplication-TileColor" content="#ff4344">
        <meta name="msapplication-config" content="/elao_/pr/629/browserconfig.xml">
        <meta name="theme-color" content="#ffffff">

                    <meta name="description" content="Installation et utilisation de Behat 3 pour vos tests fonctionnels Symfony2" />
            <link rel="canonical" href="https://elao.github.io/elao_/pr/629/blog/dev/behat-3-test-fonctionnel-symfony" />

            <!-- Open Graph / Facebook -->
            <meta property="og:title" content="Behat 3 pour vos tests fonctionnels Symfony2" />
            <meta property="og:locale" content="fr" />
            <meta property="og:description" content="Installation et utilisation de Behat 3 pour vos tests fonctionnels Symfony2" />
            <meta property="og:url" content="https://elao.github.io/elao_/pr/629/blog/dev/behat-3-test-fonctionnel-symfony" />
            <meta property="og:site_name" content="elao_" />

                                        <meta property="og:image" content="https://elao.github.io/elao_/pr/629/%2E%2E/../resized/content/images/blog/thumbnails/behat.png/c856a55f95cbcebc2090fcf42dd4f4e8.png">
            
            <!-- Twitter -->
            <meta property="twitter:card" content="summary_large_image">
            <meta property="twitter:title" content="Behat 3 pour vos tests fonctionnels Symfony2">
            <meta property="twitter:description" content="Installation et utilisation de Behat 3 pour vos tests fonctionnels Symfony2">
            <meta property="twitter:site" content="@elao">
            <meta property="twitter:creator" content="@elao">
                                        <meta property="twitter:image" content="https://elao.github.io/elao_/pr/629/%2E%2E/../resized/content/images/blog/thumbnails/behat.png/dd5febfd191d5b31aa9ee19e097a682c.png">
                            <link rel="alternate" type="application/rss+xml" href="/elao_/pr/629/blog/rss.xml" title="Le blog de l'équipe d'Elao" />
        
                <script type="application/ld+json">{
    "@context": "https://schema.org",
    "@type": "NewsArticle",
    "headline": "Behat 3 pour vos tests fonctionnels Symfony2",
    "image": [
        "https://elao.github.io/elao_/pr/629/blog/dev/content/images/blog/thumbnails/behat.png"
    ],
    "datePublished": "2016-01-06T00:00:00+00:00",
    "dateModified": "2016-01-06T00:00:00+00:00",
    "author": [
        {
            "@type": "Person",
            "name": "Nicolas Dievart",
            "url": "https://elao.github.io/elao_/pr/629/equipe"
        }
    ],
    "keywords": [
        "Behat",
        "Symfony",
        "Mink",
        "Alice"
    ]
}
    </script>
    
                            <meta name="robots" content="noindex" />
        
        <script>
                        document.querySelector('html').classList.remove('no-js');
        </script>

                    <link rel="stylesheet" href="/elao_/pr/629/build/app.ac8e82f4.css">
        
                        <script src="/elao_/pr/629/build/runtime.3ebfbea9.js" defer></script><script src="/elao_/pr/629/build/552.3082ae9c.js" defer></script><script src="/elao_/pr/629/build/769.7dfbbe52.js" defer></script><script src="/elao_/pr/629/build/app.d906f729.js" defer></script>

                    

    <script src="https://platform.twitter.com/widgets.js"></script>
    <script async defer src="//platform.instagram.com/en_US/embeds.js"></script>

    <script>
        window.onload = (function(){
            var tweets = document.querySelectorAll('.tweet-container');
            tweets.forEach(function(tweet) {
                // https://developer.twitter.com/en/docs/twitter-for-websites/embedded-tweets/guides/embedded-tweet-parameter-reference
                twttr.widgets.createTweet(tweet.getAttribute('data-tweet-id'), tweet, {
                    conversation: 'none',
                    cards: 'hidden',
                    theme: 'light',
                    lang: 'fr',
                    align: 'center',
                    width: 550, // default
                    dnt: true,
                })
            })
        });
    </script>

        <!-- S.E.E. -->
        <meta name="see" content="&#x5B;&quot;&#x5C;&#x2F;elao_&#x5C;&#x2F;pr&#x5C;&#x2F;629&#x5C;&#x2F;build&#x5C;&#x2F;see.ace7bf9f.js&quot;&#x5D;">
        <meta name="see_style" content="&#x5B;&quot;&#x5C;&#x2F;elao_&#x5C;&#x2F;pr&#x5C;&#x2F;629&#x5C;&#x2F;build&#x5C;&#x2F;see.d77e78f8.css&quot;&#x5D;">
    </head>
    <body
        data-controller="swup-plugins symfony--ux-swup--swup swup-matomo" data-symfony--ux-swup--swup-containers-value="&#x5B;&quot;&#x23;main&quot;,&quot;&#x23;nav&quot;&#x5D;" data-symfony--ux-swup--swup-cache-value="true" data-symfony--ux-swup--swup-animate-history-browsing-value="true" data-symfony--ux-swup--swup-debug-value="false" data-symfony--ux-swup--swup-link-selector-value="a&#x5B;href&#x5E;&#x3D;&quot;https&#x3A;&#x2F;&#x2F;elao.github.io&#x2F;elao_&#x2F;pr&#x2F;629&quot;&#x5D;&#x3A;not&#x28;&#x5B;data-no-swup&#x5D;&#x29;&#x3A;not&#x28;&#x5B;target&#x3D;&quot;_blank&quot;&#x5D;&#x29;&#x3A;not&#x28;a&#x5B;href&#x5E;&#x3D;&quot;https&#x3A;&#x2F;&#x2F;elao.github.io&#x2F;elao_&#x2F;pr&#x2F;629&#x2F;_profiler&quot;&#x5D;&#x29;,a&#x5B;href&#x5E;&#x3D;&quot;&#x2F;&quot;&#x5D;&#x3A;not&#x28;&#x5B;data-no-swup&#x5D;&#x29;&#x3A;not&#x28;&#x5B;target&#x3D;&quot;_blank&quot;&#x5D;&#x29;&#x3A;not&#x28;a&#x5B;href&#x5E;&#x3D;&quot;https&#x3A;&#x2F;&#x2F;elao.github.io&#x2F;elao_&#x2F;pr&#x2F;629&#x2F;_profiler&quot;&#x5D;&#x29;" data-swup-matomo-enabled-value="false">
                    <header id="nav" class="header">
                <div class="container">
                    <!--
                        Todo :
                        - only on homepage : on scroll .logo.logo--animated becomes .logo.logo--animated.logo--active (triggers its animation)
                     -->
                    <a href="/elao_/pr/629/">
                        <span class="screen-reader">Behat 3 pour vos tests fonctionnels Symfony2</span>
                                                    <svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" viewBox="0 0 300 100" class="logo logo--animated">
                                <path d="M61.6,61.6H19.7C21,69,24.8,72.2,32.6,72.2c5.9,0,8.8-1.9,11.7-7.8l16.1,6.9C56.2,82,46.9,87.8,32.1,87.8
                                    c-19.1,0-32-12.6-32-31.6c0-19.5,12.6-32.6,31.4-32.6c18.1,0,30.3,12.6,30.3,31.6C61.7,57.2,61.7,58.9,61.6,61.6z M19.6,49.3h23.6
                                    c-0.2-7.9-4.1-10.9-11.3-10.9S20.7,41.8,19.6,49.3z"/>
                                <path d="M71.2,0.1H90v86.5H71.2V0.1z"/>
                                <path d="M166.1,24.7v61.8h-18.8V72.7c-3.5,9.8-10.5,15.1-20.4,15.1c-17.7,0-27.4-12.9-27.4-32
                                    c0-19.4,9.3-32.2,26.2-32.2c10.5,0,18,5.4,21.6,15.6V24.7H166.1z M147.9,55.7c0-10.4-4.8-15.2-15.1-15.2c-9.9,0-14.6,4.8-14.6,15.2
                                    c0,10.1,4.7,14.9,14.6,14.9C143.1,70.7,147.9,65.9,147.9,55.7L147.9,55.7z"/>
                                <path d="M242.8,55.8c0,19.9-15.3,32-33.6,32s-33.6-12.1-33.6-32s15.3-32.2,33.6-32.2S242.8,35.8,242.8,55.8z M224,55.8
                                    c0-10.4-4.7-15.2-14.8-15.2c-10.1,0-14.8,4.8-14.8,15.2c0,10.1,4.7,14.9,14.8,14.9S224,65.9,224,55.8L224,55.8z"/>
                                <rect x="243.1" y="86.5" width="56.7" height="15"/>
                            </svg>
                                            </a>

                                            <!-- Desktop nav -->
                        <nav class="nav">
                            <ul>
                                                                    <li class="nav__item ">
                                        <a href="/elao_/pr/629/nos-services/">
                                                                                        <span>Services</span>
                                        </a>
                                    </li>
                                                                    <li class="nav__item ">
                                        <a href="/elao_/pr/629/demarche">
                                                                                        <span>Démarche</span>
                                        </a>
                                    </li>
                                                                    <li class="nav__item ">
                                        <a href="/elao_/pr/629/etudes-de-cas">
                                                                                        <span>Études de cas</span>
                                        </a>
                                    </li>
                                                                    <li class="nav__item ">
                                        <a href="/elao_/pr/629/nos-valeurs">
                                                                                        <span>Valeurs</span>
                                        </a>
                                    </li>
                                                                    <li class="nav__item ">
                                        <a href="/elao_/pr/629/equipe">
                                                                                        <span>L&#039;équipe</span>
                                        </a>
                                    </li>
                                                                    <li class="nav__item nav__item--active">
                                        <a href="/elao_/pr/629/blog">
                                                                                        <span>Blog</span>
                                        </a>
                                    </li>
                                                                    <li class="nav__item ">
                                        <a href="/elao_/pr/629/contact">
                                                                                            <i class="icon icon--contact" aria-hidden="true"></i>
                                                                                        <span>Contact</span>
                                        </a>
                                    </li>
                                                            </ul>
                        </nav>
                    
                                            <!-- Mobile nav -->
                        <nav class="nav-mobile" data-controller="toggle">
                            <div class="nav-mobile__header">
                                <a href="/elao_/pr/629/">
                                                                <svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" viewBox="0 0 300 100" class="logo logo--animated">
                                <path d="M61.6,61.6H19.7C21,69,24.8,72.2,32.6,72.2c5.9,0,8.8-1.9,11.7-7.8l16.1,6.9C56.2,82,46.9,87.8,32.1,87.8
                                    c-19.1,0-32-12.6-32-31.6c0-19.5,12.6-32.6,31.4-32.6c18.1,0,30.3,12.6,30.3,31.6C61.7,57.2,61.7,58.9,61.6,61.6z M19.6,49.3h23.6
                                    c-0.2-7.9-4.1-10.9-11.3-10.9S20.7,41.8,19.6,49.3z"/>
                                <path d="M71.2,0.1H90v86.5H71.2V0.1z"/>
                                <path d="M166.1,24.7v61.8h-18.8V72.7c-3.5,9.8-10.5,15.1-20.4,15.1c-17.7,0-27.4-12.9-27.4-32
                                    c0-19.4,9.3-32.2,26.2-32.2c10.5,0,18,5.4,21.6,15.6V24.7H166.1z M147.9,55.7c0-10.4-4.8-15.2-15.1-15.2c-9.9,0-14.6,4.8-14.6,15.2
                                    c0,10.1,4.7,14.9,14.6,14.9C143.1,70.7,147.9,65.9,147.9,55.7L147.9,55.7z"/>
                                <path d="M242.8,55.8c0,19.9-15.3,32-33.6,32s-33.6-12.1-33.6-32s15.3-32.2,33.6-32.2S242.8,35.8,242.8,55.8z M224,55.8
                                    c0-10.4-4.7-15.2-14.8-15.2c-10.1,0-14.8,4.8-14.8,15.2c0,10.1,4.7,14.9,14.8,14.9S224,65.9,224,55.8L224,55.8z"/>
                                <rect x="243.1" y="86.5" width="56.7" height="15"/>
                            </svg>
                        
                                </a>
                                <button class="nav-toggle nav-toggle--close">
                                    <i class="icon icon--close" aria-hidden="true"></i>
                                    <span class="screen-reader">Fermer le menu</span>
                                </button>
                            </div>
                            <ul>
                                                                    <li class="nav-mobile__item  ">
                                        <a href="/elao_/pr/629/nos-services/">
                                                                                        <span>Services</span>
                                        </a>
                                    </li>
                                                                    <li class="nav-mobile__item  ">
                                        <a href="/elao_/pr/629/demarche">
                                                                                        <span>Démarche</span>
                                        </a>
                                    </li>
                                                                    <li class="nav-mobile__item  ">
                                        <a href="/elao_/pr/629/etudes-de-cas">
                                                                                        <span>Études de cas</span>
                                        </a>
                                    </li>
                                                                    <li class="nav-mobile__item  ">
                                        <a href="/elao_/pr/629/nos-valeurs">
                                                                                        <span>Valeurs</span>
                                        </a>
                                    </li>
                                                                    <li class="nav-mobile__item  ">
                                        <a href="/elao_/pr/629/equipe">
                                                                                        <span>L&#039;équipe</span>
                                        </a>
                                    </li>
                                                                    <li class="nav-mobile__item nav-mobile__item--active ">
                                        <a href="/elao_/pr/629/blog">
                                                                                        <span>Blog</span>
                                        </a>
                                    </li>
                                                                    <li class="nav-mobile__item  nav-mobile__item--large">
                                        <a href="/elao_/pr/629/contact">
                                                                                            <i class="icon icon--contact" aria-hidden="true"></i>
                                                                                        <span>Contact</span>
                                        </a>
                                    </li>
                                                            </ul>
                        </nav>
                        <button class="nav-toggle nav-toggle--open">
                            <i class="icon icon--hamburger" aria-hidden="true"></i>
                            <span class="screen-reader">Ouvrir le menu</span>
                        </button>
                                    </div>
            </header>
                <main id="main">
                <div class="container">
                                <ol class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList">
            <li class="breadcrumb__item" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
            <a itemprop="item" href="/elao_/pr/629/">
                <span itemprop="name">Accueil</span>
            </a>
            <meta itemprop="position" content="1" />
        </li>        <li class="breadcrumb__item" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
            <a itemprop="item" href="/elao_/pr/629/blog">
                <span itemprop="name">Blog</span>
            </a>
            <meta itemprop="position" content="2" />
        </li>        <li class="breadcrumb__item" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
            <a itemprop="item" href="/elao_/pr/629/blog/dev">
                <span itemprop="name">Dev</span>
            </a>
            <meta itemprop="position" content="3" />
        </li>        <li class="breadcrumb__item" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
            <a itemprop="item" href="#">
                <span itemprop="name">Behat 3 pour vos tests fonctionnels Symfony2</span>
            </a>
            <meta itemprop="position" content="4" />
        </li></ol>

        
        <div class="article-banner">
            <div
                class="article-banner__cover"
                style="background: #f1f1f1 url('/elao_/pr/629/%2E%2E/../resized/content/images/blog/headers/behat_cover.jpg/927405b49e70f7aee428856b16ec37e7.jpg');
    background: #f1f1f1 -webkit-image-set(
        url('/elao_/pr/629/%2E%2E/../resized/content/images/blog/headers/behat_cover.jpg/927405b49e70f7aee428856b16ec37e7.jpg') 1x,
        url('/elao_/pr/629/%2E%2E/../resized/content/images/blog/headers/behat_cover.jpg/bdd5458bd06deb504160e98bdc5a1e7d.jpg') 2x
    );
    background: #f1f1f1 -moz-image-set(
        url('/elao_/pr/629/%2E%2E/../resized/content/images/blog/headers/behat_cover.jpg/927405b49e70f7aee428856b16ec37e7.jpg') 1x,
        url('/elao_/pr/629/%2E%2E/../resized/content/images/blog/headers/behat_cover.jpg/bdd5458bd06deb504160e98bdc5a1e7d.jpg') 2x
    );
    background: #f1f1f1 -ms-image-set(
        url('/elao_/pr/629/%2E%2E/../resized/content/images/blog/headers/behat_cover.jpg/927405b49e70f7aee428856b16ec37e7.jpg') 1x,
        url('/elao_/pr/629/%2E%2E/../resized/content/images/blog/headers/behat_cover.jpg/bdd5458bd06deb504160e98bdc5a1e7d.jpg') 2x
    );
    background: #f1f1f1 image-set(
        url('/elao_/pr/629/%2E%2E/../resized/content/images/blog/headers/behat_cover.jpg/927405b49e70f7aee428856b16ec37e7.jpg') 1x,
        url('/elao_/pr/629/%2E%2E/../resized/content/images/blog/headers/behat_cover.jpg/bdd5458bd06deb504160e98bdc5a1e7d.jpg') 2x
    );"
                data-aos="fade-down"
            ></div>

            <div class="article-info" data-aos="zoom-in">
                                                    <div class="article-author ">
                        <div class="article-author__image">
                                                            <a>
                                    <img     src="/elao_/pr/629/%2E%2E/../resized/content/images/members/avatars/ndievart.jpg/a74abe0a7281efd3b7446bf221cbb4f9.jpg"
    srcset="
        /elao_/pr/629/%2E%2E/../resized/content/images/members/avatars/ndievart.jpg/a74abe0a7281efd3b7446bf221cbb4f9.jpg 1x,
        /elao_/pr/629/%2E%2E/../resized/content/images/members/avatars/ndievart.jpg/0a5b8f386b3f9ef6ffd06c5654ceca72.jpg 2x
    "
 />
                                </a>
                                                    </div>
                        <span class="article-author__info">
                            Écrit par
                                                            <a href="/elao_/pr/629/blog/auteur/ndievart">
                                    <strong>Nicolas Dievart</strong>
                                </a>
                                                    </span>
                    </div>
                                <div class="article-info__date">
                    <span>Publication <strong>6 janvier 2016</strong></span>
                                                        </div>
            </div>

            <div class="article-header" data-aos="zoom-in-up">
                <h1>Behat 3 pour vos tests fonctionnels Symfony2</h1>
                <p>Installation et utilisation de Behat 3 pour vos tests fonctionnels Symfony2</p>
                <ul class="article-tag-list">
                                            <li class="article-tag-list__item">
                            <a href="/elao_/pr/629/blog/tag/behat" rel="nofollow">#Behat</a>
                        </li>
                                            <li class="article-tag-list__item">
                            <a href="/elao_/pr/629/blog/tag/symfony" rel="nofollow">#Symfony</a>
                        </li>
                                            <li class="article-tag-list__item">
                            <a href="/elao_/pr/629/blog/tag/mink" rel="nofollow">#Mink</a>
                        </li>
                                            <li class="article-tag-list__item">
                            <a href="/elao_/pr/629/blog/tag/alice" rel="nofollow">#Alice</a>
                        </li>
                                    </ul>
            </div>
        </div>

                    <ol class="table-of-content" data-aos="fade-up">
                                    <li class="table-of-content__item">
                        <a href="#behat">Behat</a>

                                            </li>
                            </ol>
        
        <div class="article-content">
            <main class="article-content__main">

                
                
                <p>Depuis peu, nous avons fait basculer notre <a href="https://github.com/Elao/symfony-standard" target="_blank">stack Symfony standard</a> avec comme dépendance par défaut Behat 3.
La documentation sur Behat 2.5 est prédominante par rapport à la version 3, ce qui nous a obligé à faire le tri pour configurer correctement notre stack.
Nous avons donc décidé de vous partager notre set up et la façon dont nous utilisons Behat 3.</p>
<!--more-->
<h2 id="behat" class="anchor-title"><a href="#behat">Behat</a></h2>
<p>Behat nous permet de réaliser les tests fonctionnels des applications que nous développons. Il a l'atout d'être extensible et nous permet d'écrire des scénarios compréhensibles à la fois par des humains et par Behat via le language <a href="http://docs.behat.org/en/latest/guides/1.gherkin.html" target="_blank">Gherkin</a>.</p>
<h3 id="installation" class="anchor-title"><a href="#installation">Installation:</a></h3>
<p>Avant toute chose, nous devons ajouter Behat à notre projet.</p>
<pre class="code-multiline language-json"><code class="language-json" id="e15abf291f01fbec67c9931fbbb0a266"><span class="token punctuation">{</span>
    <span class="token property">"require-dev"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">"behat/behat"</span><span class="token operator">:</span> <span class="token string">"3.0.*"</span><span class="token punctuation">,</span>
        <span class="token property">"behat/mink-selenium2-driver"</span><span class="token operator">:</span> <span class="token string">"1.2.*"</span><span class="token punctuation">,</span>
        <span class="token property">"behat/symfony2-extension"</span><span class="token operator">:</span> <span class="token string">"2.0.*"</span><span class="token punctuation">,</span>
        <span class="token property">"behat/mink-browserkit-driver"</span><span class="token operator">:</span> <span class="token string">"1.2.*"</span><span class="token punctuation">,</span>
        <span class="token property">"behat/mink-extension"</span><span class="token operator">:</span> <span class="token string">"~2.0"</span><span class="token punctuation">,</span>
        <span class="token property">"behat/mink-goutte-driver"</span><span class="token operator">:</span> <span class="token string">"~1.1"</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
<p>Cela fait déjà un sacré paquet de dépendances. On ne va pas toutes les détailler mais pour faire simple, elles permettent d'ajouter des <em>steps</em> par défaut qui nous serons bien utiles.</p>
<p>Après avoir lancer un <code class="code-inline" id="3dc99c89a8e5bc19d5f5f9aed42f06cf">$ composer install</code> on peut maintenant lancer un:
<code class="code-inline" id="abe40c85eebd6294e1b2efd4c8b251b0">$ vendor/bin/behat --init</code>
Ce qui va intialiser le répertoire <code class="code-inline" id="b10716f0f6bfde868629eb037eee49bd">/features</code> et créer le répertoire <code class="code-inline" id="a9917b0ef0fdd6d678e996772d6b51cf">/bootstrap</code> comportant le FeatureContext.php</p>
<h3 id="configuration" class="anchor-title"><a href="#configuration">Configuration:</a></h3>
<p>Ensuite, il faut créer un fichier <code class="code-inline" id="7bde54db60a6e933518d8b61b929edce">behat.yml.dist</code> à la racine de notre projet dans lequel on va placer la configuration de Behat.</p>
<pre class="code-multiline language-yaml"><code class="language-yaml" id="0c0a3f877d7897e6f50424274ccce89c"><span class="token key atrule">default</span><span class="token punctuation">:</span>
    <span class="token key atrule">extensions</span><span class="token punctuation">:</span>
        <span class="token key atrule">Behat\Symfony2Extension</span><span class="token punctuation">:</span> <span class="token null important">~</span>
        <span class="token key atrule">Behat\MinkExtension</span><span class="token punctuation">:</span>
            <span class="token key atrule">base_url</span><span class="token punctuation">:</span> YOUR_URL
            <span class="token key atrule">sessions</span><span class="token punctuation">:</span>
                <span class="token key atrule">default</span><span class="token punctuation">:</span>
                    <span class="token key atrule">symfony2</span><span class="token punctuation">:</span> <span class="token null important">~</span>
                <span class="token key atrule">javascript</span><span class="token punctuation">:</span>
                    <span class="token key atrule">selenium2</span><span class="token punctuation">:</span> <span class="token null important">~</span></code></pre>
<p>Afin de faire fonctionner Behat avec Symfony2, nous utilisons Behat\Symfony2Extension.</p>
<p>Concernant la configuration de MinkExtension, nous utilisons les élements par défaut, il nous suffit juste de spécifier l'url de <code class="code-inline" id="63769eef4c54174226119249021db3dc">base_url</code>, remplacer donc <code class="code-inline" id="7ef2b2e7b0fe745399470471a564ef90">YOUR_URL</code> par la route d'index de votre projet.</p>
<p><strong><em>We're all set</em></strong></p>
<p>On peut maintenant commencer à écrire nos features et à tester notre application. Créer donc un fichier <code class="code-inline" id="9838c8185c8960205f7679f5fbe90d61">hello.feature</code> dans le répertoire <code class="code-inline" id="07e93a5f6fb44673dabba783cda176ef">/feature</code></p>
<pre class="code-multiline language-gherkin"><code class="language-gherkin" id="b0bb37806c5522394ee60579c7d024f6"><span class="token feature"><span class="token keyword">Feature:</span><span class="token important"> Hello world</span>
  I need to be able to see hello world
</span>
  <span class="token scenario"><span class="token keyword">Scenario:</span><span class="token important"> I can see hello world</span></span>
    <span class="token atrule">When</span> <span class="token atrule">I</span> go to <span class="token string">"/"</span>
    <span class="token atrule">Then</span> <span class="token atrule">I</span> should see <span class="token string">"Hello World!"</span>

  <span class="token scenario"><span class="token keyword">Scenario:</span><span class="token important"> I can't see hello world</span></span>
    <span class="token atrule">When</span> <span class="token atrule">I</span> go to <span class="token string">"/random"</span>
    <span class="token atrule">Then</span> <span class="token atrule">I</span> should not see <span class="token string">"Hello World!"</span></code></pre>
<p>Il nous est possible d'écrire <em>de base</em> toutes ces étapes grâce à l'ajout de Mink. Si ces étapes ne marchent pas, vérifier bien que votre FeatureContext étend bien MinkContext.</p>
<p><code class="code-inline" id="3e5778646e0ca07ac8b594a16d164651">class FeatureContext extends MinkContext</code></p>
<h3 id="extra" class="anchor-title"><a href="#extra">Extra:</a></h3>
<p>Nous utilisons également d'autres extensions pour nous faciliter la vie, notamment Alice pour écrire nos fixtures en yaml et une extension Behat pour appeler nos fixtures au moment où elles sont nécessaires.</p>
<pre class="code-multiline language-json"><code class="language-json" id="2d2f0ffb5db82cd945663a81b90e72cd"><span class="token punctuation">{</span>
    require<span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">"nelmio/alice"</span><span class="token operator">:</span> <span class="token string">"2.1.*"</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    require-dev<span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">"hautelook/alice-bundle"</span><span class="token operator">:</span> <span class="token string">"~1.0"</span><span class="token punctuation">,</span>
        <span class="token property">"theofidry/alice-bundle-extension"</span><span class="token operator">:</span> <span class="token string">"v1.0.0"</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
<p>Pour la configuration dans <code class="code-inline" id="7bde54db60a6e933518d8b61b929edce">behat.yml.dist</code>, on ajoute la configuration suivante pour utiliser l'extension Alice</p>
<pre class="code-multiline language-yaml"><code class="language-yaml" id="f4988b10391b1f59357e5e77941bbfe7"><span class="token key atrule">suites</span><span class="token punctuation">:</span>
        <span class="token key atrule">default</span><span class="token punctuation">:</span>
            <span class="token key atrule">contexts</span><span class="token punctuation">:</span>
                <span class="token punctuation">-</span> <span class="token key atrule">Fidry\AliceBundleExtension\Context\Doctrine\AliceORMContext</span><span class="token punctuation">:</span>
                    <span class="token key atrule">basePath</span><span class="token punctuation">:</span> %paths.base%/features/fixtures
                <span class="token punctuation">-</span> <span class="token key atrule">FeatureContext</span><span class="token punctuation">:</span> <span class="token null important">~</span></code></pre>
<p>Il est intéressant de noter également que l'on peut utiliser <code class="code-inline" id="1d2f9e5a016b157f0cc30ff4c0890c2c">fzaninotto/faker</code> avec l'extension Alice, ce qui permet de faire facilement et rapidement des fixtures de tests pour nos projets.</p>
<p>Nous avons pris l'habitude, lors de nos tests, de réinitialiser la base de données afin que nos données de tests n'interfèrent pas les unes entre elles. Pour ce faire, nous utilisons une <em>step</em> du AliceORMContext que nous venons de définir dans les context de notre fichier <code class="code-inline" id="7bde54db60a6e933518d8b61b929edce">behat.yml.dist</code> que nous jouons dans le background de chacun de nos scénarios.</p>
<p>Ce qui nous permet de faire des features comme cela:</p>
<pre class="code-multiline language-gherkin"><code class="language-gherkin" id="29f633c66baf64538168f23b3b6ce510"><span class="token feature"><span class="token keyword">Feature:</span><span class="token important"> Go to the second page</span>
  I need to be able to go to the second page
</span>
  <span class="token scenario"><span class="token keyword">Background:</span><span class="token important"> Re-init the database and load the fixtures</span></span>
    <span class="token atrule">Given</span> the database is empty
    <span class="token atrule">And</span> the fixtures <span class="token string">"data.yml"</span> are loaded

  <span class="token scenario"><span class="token keyword">Scenario:</span><span class="token important"> I can go to the second page and see my data</span></span>
    <span class="token atrule">When</span> the fixtures <span class="token string">"data2.yml"</span> are loaded
    <span class="token atrule">Then</span> <span class="token atrule">I</span> go to <span class="token string">"/"</span>
    <span class="token atrule">And</span> <span class="token atrule">I</span> should see <span class="token string">"Go to next page"</span>
    <span class="token atrule">Then</span> <span class="token atrule">I</span> follow <span class="token string">"Go to next page"</span>
    <span class="token atrule">And</span> <span class="token atrule">I</span> should be on <span class="token string">"/page2"</span>
    <span class="token atrule">And</span> <span class="token atrule">I</span> should see <span class="token string">"data"</span></code></pre>
<p>Il faut donc modifier le FeatureContext pour qu'il comporte une implémentation du KernelAwareContext pour pouvoir jouer nos <em>steps</em> :</p>
<pre class="code-multiline language-php"><code class="language-php" id="8a623fe72d52beddfe17c5a05457d6f4"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token keyword">use</span> <span class="token package">Behat<span class="token punctuation">\</span>Behat<span class="token punctuation">\</span>Context<span class="token punctuation">\</span>SnippetAcceptingContext</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Behat<span class="token punctuation">\</span>MinkExtension<span class="token punctuation">\</span>Context<span class="token punctuation">\</span>MinkContext</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Behat<span class="token punctuation">\</span>Symfony2Extension<span class="token punctuation">\</span>Context<span class="token punctuation">\</span>KernelAwareContext</span><span class="token punctuation">;</span>

<span class="token doc-comment comment">/**
 * Defines application features from the specific context.
 */</span>
<span class="token keyword">class</span> <span class="token class-name-definition class-name">FeatureContext</span> <span class="token keyword">extends</span> <span class="token class-name">MinkContext</span> <span class="token keyword">implements</span> <span class="token class-name">KernelAwareContext</span><span class="token punctuation">,</span> SnippetAcceptingContext
<span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token variable">$kernel</span><span class="token punctuation">;</span>

    <span class="token doc-comment comment">/**
     * Initializes context.
     *
     * Every scenario gets its own context instance.
     * You can also pass arbitrary arguments to the
     * context constructor through behat.yml.
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     * <span class="token keyword">@param</span> <span class="token class-name"><span class="token punctuation">\</span>Symfony<span class="token punctuation">\</span>Component<span class="token punctuation">\</span>HttpKernel<span class="token punctuation">\</span>KernelInterface</span> <span class="token parameter">$kernel</span>
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">setKernel</span><span class="token punctuation">(</span><span class="token class-name class-name-fully-qualified type-declaration"><span class="token punctuation">\</span>Symfony<span class="token punctuation">\</span>Component<span class="token punctuation">\</span>HttpKernel<span class="token punctuation">\</span>KernelInterface</span> <span class="token variable">$kernel</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token this keyword">$this</span><span class="token operator">-&gt;</span><span class="token property">kernel</span> <span class="token operator">=</span> <span class="token variable">$kernel</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></span></code></pre>
<h3 id="en-conclusion" class="anchor-title"><a href="#en-conclusion">En conclusion</a></h3>
<p>Une configuration un peu différence de Behat 2.5 mais pas si compliquée comme on a pu le voir.</p>
<p>Des extensions bien utiles pour faire des fixtures en yaml et obtenir des <code class="code-inline" id="fca3ffea6534176432f58b5a22ed22e1">steps</code> déjà fonctionnels.</p>
<p>Nous privilégions la regénération de nos fixtures à chacun de nos tests, ce qui permet de ne pas polluer les tests entre eux. Si un test change une valeur, le second n'a pas à la prendre en compte, la valeur est remise à l'initiale.</p>
<p>Et enfin, Behat c'est bien, mangez en!</p>
                                                                </main>
            <aside class="article-content__aside">
                            </aside>
        </div>

        <div class="article-footer" data-aos="fade-in">
                                                <div class="article-author">
                        <div class="article-author__image">
                            <a>
                                <img     src="/elao_/pr/629/%2E%2E/../resized/content/images/members/avatars/ndievart.jpg/a74abe0a7281efd3b7446bf221cbb4f9.jpg"
    srcset="
        /elao_/pr/629/%2E%2E/../resized/content/images/members/avatars/ndievart.jpg/a74abe0a7281efd3b7446bf221cbb4f9.jpg 1x,
        /elao_/pr/629/%2E%2E/../resized/content/images/members/avatars/ndievart.jpg/0a5b8f386b3f9ef6ffd06c5654ceca72.jpg 2x
    "
 />
                            </a>
                        </div>
                        <span class="article-author__info">
                            Écrit par
                            <a>
                                <strong>Nicolas Dievart</strong>
                            </a>
                        </span>

                        <div class="article-author__social">
                                                                                        <a href="https://github.com/NicolasDievart " class="social social--small">
                                    <i class="icon icon--github" aria-hidden="true"></i>
                                    <span class="screen-reader">Compte github de Nicolas Dievart</span>
                                </a>
                                                                                        <a href="http://www.elao.com" class="social social--small">
                                    <i class="icon icon--website" aria-hidden="true"></i>
                                    <span class="screen-reader">Site personnel de Nicolas Dievart</span>
                                </a>
                                                    </div>
                    </div>
                                    </div>

                <div class="bricks">
            
                            <div class="brick-contribute">
                    <p>
                        Une typo ?
                        <a href="https://github.com/Elao/elao_/edit/remove_members/content/blog/dev/behat-3-test-fonctionnel-symfony.md/" target="_blank" class="animated-link animated-link--light">
                            Modifier cet article sur Github
                        </a>
                    </p>
                </div>
                    </div>
            </div>
        </main>
                    
<footer class="footer">
    <div class="container">
        <section class="footer__links">
            <p class="h1">
                elao
                <span>développe</span>
                <span>du lien</span>
            </p>
            <div class="links">
                                    <ul>
                                                    <li>
                                <a href="/elao_/pr/629/nos-services/" >Services</a>
                            </li>
                                                    <li>
                                <a href="/elao_/pr/629/demarche" >Démarche</a>
                            </li>
                                                    <li>
                                <a href="/elao_/pr/629/etudes-de-cas" >Études de cas</a>
                            </li>
                                            </ul>
                                    <ul>
                                                    <li>
                                <a href="/elao_/pr/629/nos-valeurs" >Valeurs</a>
                            </li>
                                                    <li>
                                <a href="/elao_/pr/629/equipe" >L&#039;équipe</a>
                            </li>
                                                    <li>
                                <a href="/elao_/pr/629/blog" >Blog</a>
                            </li>
                                                    <li>
                                <a href="/elao_/pr/629/blog/rss.xml"  data-no-swup="data-no-swup">RSS</a>
                            </li>
                                            </ul>
                                <ul>
                    <li>
                                                <a href="/elao_/pr/629/recrutement">
                            Nous recrutons
                                                            <span class="bullet">2</span>
                                                    </a>
                    </li>
                    <li>
                        <a href="/elao_/pr/629/glossaire/">Glossaire 🧐</a>
                    </li>
                    <li>
                        <a href="/elao_/pr/629/elaomojis">Elaomojis 🎉</a>
                    </li>
                </ul>
            </div>
            <div class="socials">
                <ul>
                    <li>
                        <a href="https://github.com/elao" target="_blank">
                            <i class="icon icon--github"></i>
                            Github
                        </a>
                    </li>
                    <li>
                        <a href="https://twitter.com/elao" target="_blank">
                            <i class="icon icon--x"></i>
                            Twitter
                        </a>
                    </li>
                    <li>
                        <a href="https://www.linkedin.com/company/elao/mycompany/" target="_blank">
                            <i class="icon icon--linkedin"></i>
                            Linkedin
                        </a>
                    </li>
                </ul>
            </div>
            <div class="contacts">
                <ul>
                    <li>
                        <a href="/elao_/pr/629/contact">Contact</a>
                    </li>
                    <li>
                        <a href="tel:04 82 53 37 19">04 82 53 37 19</a>
                    </li>
                    <li>
                        <a href="mailto:contact@elao.com">contact@elao.com</a>
                    </li>
                    <li>34 rue Jean Broquin</li>
                    <li>69006 Lyon</li>
                </ul>
            </div>
        </section>

        <section class="footer__legals">
            <span>© 2005 - 2024 - ELAO - Tous droits réservés</span>
            <a href="/elao_/pr/629/legal">Mentions légales</a>
            <a href="/elao_/pr/629/confidentialite">Protection des données</a>
            <a id="see" href="#ssss">🐍</a>
        </section>
    </div>
</footer>

            </body>
</html>
