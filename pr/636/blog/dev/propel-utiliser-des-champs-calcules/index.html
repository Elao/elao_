<!DOCTYPE html>
<html lang="fr" class="no-js">
    <head>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>Propel - Utiliser des champs calculés</title>

        <!-- Favicon -->
        <link rel="apple-touch-icon" sizes="180x180" href="/elao_/pr/636/apple-touch-icon.png">
        <link rel="icon" type="image/png" sizes="32x32" href="/elao_/pr/636/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/elao_/pr/636/favicon-16x16.png">
        <link rel="manifest" href="/elao_/pr/636/site.webmanifest">
        <link rel="mask-icon" href="/elao_/pr/636/safari-pinned-tab.svg" color="#ff4344">
        <link rel="shortcut icon" href="/elao_/pr/636/favicon.ico">
        <meta name="msapplication-TileColor" content="#ff4344">
        <meta name="msapplication-config" content="/elao_/pr/636/browserconfig.xml">
        <meta name="theme-color" content="#ffffff">

                    <meta name="description" content="Propel - Utiliser des champs calculés" />
            <link rel="canonical" href="https://elao.github.io/elao_/pr/636/blog/dev/propel-utiliser-des-champs-calcules" />

            <!-- Open Graph / Facebook -->
            <meta property="og:title" content="Propel - Utiliser des champs calculés" />
            <meta property="og:locale" content="fr" />
            <meta property="og:description" content="Propel - Utiliser des champs calculés" />
            <meta property="og:url" content="https://elao.github.io/elao_/pr/636/blog/dev/propel-utiliser-des-champs-calcules" />
            <meta property="og:site_name" content="elao_" />

                                        <meta property="og:image" content="https://elao.github.io/elao_/pr/636/%2E%2E/../resized/content/images/blog/thumbnails/mailers.jpg/615ee5022a206794c29440eefc8e30f1.jpg">
            
            <!-- Twitter -->
            <meta property="twitter:card" content="summary_large_image">
            <meta property="twitter:title" content="Propel - Utiliser des champs calculés">
            <meta property="twitter:description" content="Propel - Utiliser des champs calculés">
            <meta property="twitter:site" content="@elao">
            <meta property="twitter:creator" content="@elao">
                                        <meta property="twitter:image" content="https://elao.github.io/elao_/pr/636/%2E%2E/../resized/content/images/blog/thumbnails/mailers.jpg/502241d3d8fa3a64521eff3710abb87a.jpg">
                            <link rel="alternate" type="application/rss+xml" href="/elao_/pr/636/blog/rss.xml" title="Le blog de l'équipe d'Elao" />
        
                <script type="application/ld+json">{
    "@context": "https://schema.org",
    "@type": "NewsArticle",
    "headline": "Propel - Utiliser des champs calculés",
    "image": [
        "https://elao.github.io/elao_/pr/636/blog/dev/content/images/blog/thumbnails/mailers.jpg"
    ],
    "datePublished": "2010-05-13T00:00:00+00:00",
    "dateModified": "2010-05-13T00:00:00+00:00",
    "author": [
        {
            "@type": "Person",
            "name": "Guewen Faivre",
            "url": "https://elao.github.io/elao_/pr/636/equipe/gfaivre"
        }
    ],
    "keywords": [
        "Propel",
        "Php",
        "Orm",
        "Symfony"
    ]
}
    </script>
    
                            <meta name="robots" content="noindex" />
        
        <script>
                        document.querySelector('html').classList.remove('no-js');
        </script>

                    <link rel="stylesheet" href="/elao_/pr/636/build/app.d2114747.css">
        
                        <script src="/elao_/pr/636/build/runtime.2edec85f.js" defer></script><script src="/elao_/pr/636/build/552.3082ae9c.js" defer></script><script src="/elao_/pr/636/build/769.7dfbbe52.js" defer></script><script src="/elao_/pr/636/build/app.d906f729.js" defer></script>

                    

    <script src="https://platform.twitter.com/widgets.js"></script>
    <script async defer src="//platform.instagram.com/en_US/embeds.js"></script>

    <script>
        window.onload = (function(){
            var tweets = document.querySelectorAll('.tweet-container');
            tweets.forEach(function(tweet) {
                // https://developer.twitter.com/en/docs/twitter-for-websites/embedded-tweets/guides/embedded-tweet-parameter-reference
                twttr.widgets.createTweet(tweet.getAttribute('data-tweet-id'), tweet, {
                    conversation: 'none',
                    cards: 'hidden',
                    theme: 'light',
                    lang: 'fr',
                    align: 'center',
                    width: 550, // default
                    dnt: true,
                })
            })
        });
    </script>

        <!-- S.E.E. -->
        <meta name="see" content="&#x5B;&quot;&#x5C;&#x2F;elao_&#x5C;&#x2F;pr&#x5C;&#x2F;636&#x5C;&#x2F;build&#x5C;&#x2F;see.ace7bf9f.js&quot;&#x5D;">
        <meta name="see_style" content="&#x5B;&quot;&#x5C;&#x2F;elao_&#x5C;&#x2F;pr&#x5C;&#x2F;636&#x5C;&#x2F;build&#x5C;&#x2F;see.d77e78f8.css&quot;&#x5D;">
    </head>
    <body
        data-controller="swup-plugins symfony--ux-swup--swup swup-matomo" data-symfony--ux-swup--swup-containers-value="&#x5B;&quot;&#x23;main&quot;,&quot;&#x23;nav&quot;&#x5D;" data-symfony--ux-swup--swup-cache-value="true" data-symfony--ux-swup--swup-animate-history-browsing-value="true" data-symfony--ux-swup--swup-debug-value="false" data-symfony--ux-swup--swup-link-selector-value="a&#x5B;href&#x5E;&#x3D;&quot;https&#x3A;&#x2F;&#x2F;elao.github.io&#x2F;elao_&#x2F;pr&#x2F;636&quot;&#x5D;&#x3A;not&#x28;&#x5B;data-no-swup&#x5D;&#x29;&#x3A;not&#x28;&#x5B;target&#x3D;&quot;_blank&quot;&#x5D;&#x29;&#x3A;not&#x28;a&#x5B;href&#x5E;&#x3D;&quot;https&#x3A;&#x2F;&#x2F;elao.github.io&#x2F;elao_&#x2F;pr&#x2F;636&#x2F;_profiler&quot;&#x5D;&#x29;,a&#x5B;href&#x5E;&#x3D;&quot;&#x2F;&quot;&#x5D;&#x3A;not&#x28;&#x5B;data-no-swup&#x5D;&#x29;&#x3A;not&#x28;&#x5B;target&#x3D;&quot;_blank&quot;&#x5D;&#x29;&#x3A;not&#x28;a&#x5B;href&#x5E;&#x3D;&quot;https&#x3A;&#x2F;&#x2F;elao.github.io&#x2F;elao_&#x2F;pr&#x2F;636&#x2F;_profiler&quot;&#x5D;&#x29;" data-swup-matomo-enabled-value="false">
                    <header id="nav" class="header">
                <div class="container">
                    <!--
                        Todo :
                        - only on homepage : on scroll .logo.logo--animated becomes .logo.logo--animated.logo--active (triggers its animation)
                     -->
                    <a href="/elao_/pr/636/">
                        <span class="screen-reader">Propel - Utiliser des champs calculés</span>
                                                    <svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" viewBox="0 0 300 100" class="logo logo--animated">
                                <path d="M61.6,61.6H19.7C21,69,24.8,72.2,32.6,72.2c5.9,0,8.8-1.9,11.7-7.8l16.1,6.9C56.2,82,46.9,87.8,32.1,87.8
                                    c-19.1,0-32-12.6-32-31.6c0-19.5,12.6-32.6,31.4-32.6c18.1,0,30.3,12.6,30.3,31.6C61.7,57.2,61.7,58.9,61.6,61.6z M19.6,49.3h23.6
                                    c-0.2-7.9-4.1-10.9-11.3-10.9S20.7,41.8,19.6,49.3z"/>
                                <path d="M71.2,0.1H90v86.5H71.2V0.1z"/>
                                <path d="M166.1,24.7v61.8h-18.8V72.7c-3.5,9.8-10.5,15.1-20.4,15.1c-17.7,0-27.4-12.9-27.4-32
                                    c0-19.4,9.3-32.2,26.2-32.2c10.5,0,18,5.4,21.6,15.6V24.7H166.1z M147.9,55.7c0-10.4-4.8-15.2-15.1-15.2c-9.9,0-14.6,4.8-14.6,15.2
                                    c0,10.1,4.7,14.9,14.6,14.9C143.1,70.7,147.9,65.9,147.9,55.7L147.9,55.7z"/>
                                <path d="M242.8,55.8c0,19.9-15.3,32-33.6,32s-33.6-12.1-33.6-32s15.3-32.2,33.6-32.2S242.8,35.8,242.8,55.8z M224,55.8
                                    c0-10.4-4.7-15.2-14.8-15.2c-10.1,0-14.8,4.8-14.8,15.2c0,10.1,4.7,14.9,14.8,14.9S224,65.9,224,55.8L224,55.8z"/>
                                <rect x="243.1" y="86.5" width="56.7" height="15"/>
                            </svg>
                                            </a>

                                            <!-- Desktop nav -->
                        <nav class="nav">
                            <ul>
                                                                    <li class="nav__item ">
                                        <a href="/elao_/pr/636/nos-services/">
                                                                                        <span>Services</span>
                                        </a>
                                    </li>
                                                                    <li class="nav__item ">
                                        <a href="/elao_/pr/636/demarche">
                                                                                        <span>Démarche</span>
                                        </a>
                                    </li>
                                                                    <li class="nav__item ">
                                        <a href="/elao_/pr/636/etudes-de-cas">
                                                                                        <span>Études de cas</span>
                                        </a>
                                    </li>
                                                                    <li class="nav__item ">
                                        <a href="/elao_/pr/636/nos-valeurs">
                                                                                        <span>Valeurs</span>
                                        </a>
                                    </li>
                                                                    <li class="nav__item ">
                                        <a href="/elao_/pr/636/equipe">
                                                                                        <span>L&#039;équipe</span>
                                        </a>
                                    </li>
                                                                    <li class="nav__item nav__item--active">
                                        <a href="/elao_/pr/636/blog">
                                                                                        <span>Blog</span>
                                        </a>
                                    </li>
                                                                    <li class="nav__item ">
                                        <a href="/elao_/pr/636/contact">
                                                                                            <i class="icon icon--contact" aria-hidden="true"></i>
                                                                                        <span>Contact</span>
                                        </a>
                                    </li>
                                                            </ul>
                        </nav>
                    
                                            <!-- Mobile nav -->
                        <nav class="nav-mobile" data-controller="toggle">
                            <div class="nav-mobile__header">
                                <a href="/elao_/pr/636/">
                                                                <svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" viewBox="0 0 300 100" class="logo logo--animated">
                                <path d="M61.6,61.6H19.7C21,69,24.8,72.2,32.6,72.2c5.9,0,8.8-1.9,11.7-7.8l16.1,6.9C56.2,82,46.9,87.8,32.1,87.8
                                    c-19.1,0-32-12.6-32-31.6c0-19.5,12.6-32.6,31.4-32.6c18.1,0,30.3,12.6,30.3,31.6C61.7,57.2,61.7,58.9,61.6,61.6z M19.6,49.3h23.6
                                    c-0.2-7.9-4.1-10.9-11.3-10.9S20.7,41.8,19.6,49.3z"/>
                                <path d="M71.2,0.1H90v86.5H71.2V0.1z"/>
                                <path d="M166.1,24.7v61.8h-18.8V72.7c-3.5,9.8-10.5,15.1-20.4,15.1c-17.7,0-27.4-12.9-27.4-32
                                    c0-19.4,9.3-32.2,26.2-32.2c10.5,0,18,5.4,21.6,15.6V24.7H166.1z M147.9,55.7c0-10.4-4.8-15.2-15.1-15.2c-9.9,0-14.6,4.8-14.6,15.2
                                    c0,10.1,4.7,14.9,14.6,14.9C143.1,70.7,147.9,65.9,147.9,55.7L147.9,55.7z"/>
                                <path d="M242.8,55.8c0,19.9-15.3,32-33.6,32s-33.6-12.1-33.6-32s15.3-32.2,33.6-32.2S242.8,35.8,242.8,55.8z M224,55.8
                                    c0-10.4-4.7-15.2-14.8-15.2c-10.1,0-14.8,4.8-14.8,15.2c0,10.1,4.7,14.9,14.8,14.9S224,65.9,224,55.8L224,55.8z"/>
                                <rect x="243.1" y="86.5" width="56.7" height="15"/>
                            </svg>
                        
                                </a>
                                <button class="nav-toggle nav-toggle--close">
                                    <i class="icon icon--close" aria-hidden="true"></i>
                                    <span class="screen-reader">Fermer le menu</span>
                                </button>
                            </div>
                            <ul>
                                                                    <li class="nav-mobile__item  ">
                                        <a href="/elao_/pr/636/nos-services/">
                                                                                        <span>Services</span>
                                        </a>
                                    </li>
                                                                    <li class="nav-mobile__item  ">
                                        <a href="/elao_/pr/636/demarche">
                                                                                        <span>Démarche</span>
                                        </a>
                                    </li>
                                                                    <li class="nav-mobile__item  ">
                                        <a href="/elao_/pr/636/etudes-de-cas">
                                                                                        <span>Études de cas</span>
                                        </a>
                                    </li>
                                                                    <li class="nav-mobile__item  ">
                                        <a href="/elao_/pr/636/nos-valeurs">
                                                                                        <span>Valeurs</span>
                                        </a>
                                    </li>
                                                                    <li class="nav-mobile__item  ">
                                        <a href="/elao_/pr/636/equipe">
                                                                                        <span>L&#039;équipe</span>
                                        </a>
                                    </li>
                                                                    <li class="nav-mobile__item nav-mobile__item--active ">
                                        <a href="/elao_/pr/636/blog">
                                                                                        <span>Blog</span>
                                        </a>
                                    </li>
                                                                    <li class="nav-mobile__item  nav-mobile__item--large">
                                        <a href="/elao_/pr/636/contact">
                                                                                            <i class="icon icon--contact" aria-hidden="true"></i>
                                                                                        <span>Contact</span>
                                        </a>
                                    </li>
                                                            </ul>
                        </nav>
                        <button class="nav-toggle nav-toggle--open">
                            <i class="icon icon--hamburger" aria-hidden="true"></i>
                            <span class="screen-reader">Ouvrir le menu</span>
                        </button>
                                    </div>
            </header>
                <main id="main">
                <div class="container">
                                <ol class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList">
            <li class="breadcrumb__item" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
            <a itemprop="item" href="/elao_/pr/636/">
                <span itemprop="name">Accueil</span>
            </a>
            <meta itemprop="position" content="1" />
        </li>        <li class="breadcrumb__item" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
            <a itemprop="item" href="/elao_/pr/636/blog">
                <span itemprop="name">Blog</span>
            </a>
            <meta itemprop="position" content="2" />
        </li>        <li class="breadcrumb__item" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
            <a itemprop="item" href="/elao_/pr/636/blog/dev">
                <span itemprop="name">Dev</span>
            </a>
            <meta itemprop="position" content="3" />
        </li>        <li class="breadcrumb__item" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
            <a itemprop="item" href="#">
                <span itemprop="name">Propel - Utiliser des champs calculés</span>
            </a>
            <meta itemprop="position" content="4" />
        </li></ol>

        
        <div class="article-banner">
            <div
                class="article-banner__cover"
                style="background: #f1f1f1 url('/elao_/pr/636/%2E%2E/../resized/content/images/blog/thumbnails/mailers.jpg/92bb469c95b0d196f6aba2bfd598d16c.jpg');
    background: #f1f1f1 -webkit-image-set(
        url('/elao_/pr/636/%2E%2E/../resized/content/images/blog/thumbnails/mailers.jpg/92bb469c95b0d196f6aba2bfd598d16c.jpg') 1x,
        url('/elao_/pr/636/%2E%2E/../resized/content/images/blog/thumbnails/mailers.jpg/a7b4161e2375a9f0e905c8ad1954738c.jpg') 2x
    );
    background: #f1f1f1 -moz-image-set(
        url('/elao_/pr/636/%2E%2E/../resized/content/images/blog/thumbnails/mailers.jpg/92bb469c95b0d196f6aba2bfd598d16c.jpg') 1x,
        url('/elao_/pr/636/%2E%2E/../resized/content/images/blog/thumbnails/mailers.jpg/a7b4161e2375a9f0e905c8ad1954738c.jpg') 2x
    );
    background: #f1f1f1 -ms-image-set(
        url('/elao_/pr/636/%2E%2E/../resized/content/images/blog/thumbnails/mailers.jpg/92bb469c95b0d196f6aba2bfd598d16c.jpg') 1x,
        url('/elao_/pr/636/%2E%2E/../resized/content/images/blog/thumbnails/mailers.jpg/a7b4161e2375a9f0e905c8ad1954738c.jpg') 2x
    );
    background: #f1f1f1 image-set(
        url('/elao_/pr/636/%2E%2E/../resized/content/images/blog/thumbnails/mailers.jpg/92bb469c95b0d196f6aba2bfd598d16c.jpg') 1x,
        url('/elao_/pr/636/%2E%2E/../resized/content/images/blog/thumbnails/mailers.jpg/a7b4161e2375a9f0e905c8ad1954738c.jpg') 2x
    );"
                data-aos="fade-down"
            ></div>

            <div class="article-info" data-aos="zoom-in">
                                                    <div class="article-author ">
                        <div class="article-author__image">
                                                            <a href="/elao_/pr/636/blog/auteur/gfaivre">
                                    <img     src="/elao_/pr/636/%2E%2E/../resized/content/images/members/avatars/gfaivre.jpg/0b15d32360625605c83c974bf168637b.jpg"
    srcset="
        /elao_/pr/636/%2E%2E/../resized/content/images/members/avatars/gfaivre.jpg/0b15d32360625605c83c974bf168637b.jpg 1x,
        /elao_/pr/636/%2E%2E/../resized/content/images/members/avatars/gfaivre.jpg/f804161347eed9c67c0f2c20a4f1fc65.jpg 2x
    "
 />
                                </a>
                                                    </div>
                        <span class="article-author__info">
                            Écrit par
                                                            <a href="/elao_/pr/636/blog/auteur/gfaivre">
                                    <strong>Guewen Faivre</strong>
                                </a>
                                                    </span>
                    </div>
                                <div class="article-info__date">
                    <span>Publication <strong>13 mai 2010</strong></span>
                                                        </div>
            </div>

            <div class="article-header" data-aos="zoom-in-up">
                <h1>Propel - Utiliser des champs calculés</h1>
                <p>Propel - Utiliser des champs calculés</p>
                <ul class="article-tag-list">
                                            <li class="article-tag-list__item">
                            <a href="/elao_/pr/636/blog/tag/propel" rel="nofollow">#Propel</a>
                        </li>
                                            <li class="article-tag-list__item">
                            <a href="/elao_/pr/636/blog/tag/php" rel="nofollow">#Php</a>
                        </li>
                                            <li class="article-tag-list__item">
                            <a href="/elao_/pr/636/blog/tag/orm" rel="nofollow">#Orm</a>
                        </li>
                                            <li class="article-tag-list__item">
                            <a href="/elao_/pr/636/blog/tag/symfony" rel="nofollow">#Symfony</a>
                        </li>
                                    </ul>
            </div>
        </div>

        
        <div class="article-content">
            <main class="article-content__main">

                
                
                <p>Il est parfois très utile de pouvoir récupérer directement des champs calculés depuis la base de données, soit parce que passer par un criteria s'avère très compliqué, voir impossible, soit pour confier les calculs à la base de données.</p>
<p>Je vous propose donc aujourd'hui deux solutions pour le faire avec Propel :<!--more--></p>
<h3 id="1ere-solution-les-resultats-sont-accedes-via-des-index-numeriques" class="anchor-title"><a href="#1ere-solution-les-resultats-sont-accedes-via-des-index-numeriques">1ère solution, les résultats sont accédés via des index numériques</a></h3>
<pre class="code-multiline language-php"><code class="language-php" id="8a7785275a13d5b475a4c186b07d0e48"><span class="token comment">//QUERY</span>
<span class="token variable">$query</span> <span class="token operator">=</span> <span class="token constant">SELECT</span> <span class="token function">DISTINCT</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'.UserPeer::ID.'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'.UserPeer::FIRSTNAME.'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'.UserPeer::LASTNAME.'</span><span class="token punctuation">,</span>
                         <span class="token string single-quoted-string">'.UserPeer::NICKNAME.'</span><span class="token punctuation">,</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'.QuestionPeer::ID.'</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> <span class="token constant">NB_QUESTIONS</span><span class="token punctuation">,</span>
                         <span class="token string single-quoted-string">'.QuestionPeer::LEVEL.'</span>
         <span class="token constant">FROM</span> <span class="token string single-quoted-string">'.UserPeer::TABLE_NAME.'</span>
         <span class="token constant">INNER</span> <span class="token constant">JOIN</span> <span class="token string single-quoted-string">'.QuestionPeer::TABLE_NAME.'</span>
         <span class="token constant">ON</span> <span class="token string single-quoted-string">'.QuestionPeer::USER_ID.'</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'.UserPeer::ID.'</span>
         <span class="token constant">WHERE</span> <span class="token string single-quoted-string">'.QuestionPeer::IS_VALID.'</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token string single-quoted-string">'
         GROUP BY '</span><span class="token operator">.</span><span class="token scope">UserPeer<span class="token punctuation">::</span></span><span class="token constant">ID</span><span class="token operator">.</span><span class="token string single-quoted-string">', '</span><span class="token operator">.</span><span class="token scope">QuestionPeer<span class="token punctuation">::</span></span><span class="token constant">LEVEL</span><span class="token operator">.</span><span class="token string single-quoted-string">'
         ORDER BY '</span><span class="token operator">.</span><span class="token scope">QuestionPeer<span class="token punctuation">::</span></span><span class="token constant">LEVEL</span><span class="token punctuation">;</span>
<span class="token variable">$stmt</span> <span class="token operator">=</span> <span class="token variable">$con</span><span class="token operator">-&gt;</span><span class="token function">prepareStatement</span><span class="token punctuation">(</span><span class="token variable">$query</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$rs</span> <span class="token operator">=</span> <span class="token variable">$stmt</span><span class="token operator">-&gt;</span><span class="token function">executeQuery</span><span class="token punctuation">(</span><span class="token scope">ResultSet<span class="token punctuation">::</span></span><span class="token constant">FETCHMODE_NUM</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// PARSING RESULTS</span>
<span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token variable">$rs</span><span class="token operator">-&gt;</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
  <span class="token variable">$users</span><span class="token punctuation">[</span><span class="token variable">$rs</span><span class="token operator">-&gt;</span><span class="token function">getInt</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'nickname'</span>  <span class="token operator">=&gt;</span> <span class="token variable">$rs</span><span class="token operator">-&gt;</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                                 <span class="token string single-quoted-string">'firstname'</span> <span class="token operator">=&gt;</span> <span class="token variable">$rs</span><span class="token operator">-&gt;</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                                 <span class="token string single-quoted-string">'lastname'</span>  <span class="token operator">=&gt;</span> <span class="token variable">$rs</span><span class="token operator">-&gt;</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                           <span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token variable">$level</span> <span class="token operator">=</span> <span class="token variable">$rs</span><span class="token operator">-&gt;</span><span class="token function">getInt</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token variable">$questions</span><span class="token punctuation">[</span><span class="token variable">$rs</span><span class="token operator">-&gt;</span><span class="token function">getInt</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token variable">$level</span> <span class="token operator">&lt;</span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token variable">$level</span> <span class="token punctuation">:</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$rs</span><span class="token operator">-&gt;</span><span class="token function">getInt</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token variable">$users</span><span class="token punctuation">[</span><span class="token variable">$rs</span><span class="token operator">-&gt;</span><span class="token function">getInt</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'questions'</span><span class="token punctuation">]</span>                     <span class="token operator">=</span> <span class="token variable">$questions</span><span class="token punctuation">[</span><span class="token variable">$rs</span><span class="token operator">-&gt;</span><span class="token function">getInt</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
<h3 id="2eme-solution-les-resultats-sont-accedes-via-les-noms-de-champs-renvoyes-par-la-requete" class="anchor-title"><a href="#2eme-solution-les-resultats-sont-accedes-via-les-noms-de-champs-renvoyes-par-la-requete">2ème solution, les résultats sont accédés via les noms de champs renvoyés par la requête</a></h3>
<p>Il suffit pour cela de remplacer la méthode de récupération de executeQuery en utilisant cette fois:</p>
<pre class="code-multiline language-php"><code class="language-php" id="7996141236245e4babf93b780a90018b"><span class="token scope">ResultSet<span class="token punctuation">::</span></span><span class="token constant">FETCHMODE_ASSOC</span></code></pre>
<pre class="code-multiline"><code id="2e51ed954b18dd9b6cd37f86ccc62dc7">$rs = $stmt-&gt;executeQuery(ResultSet::FETCHMODE_ASSOC);
// PARSING RESULTS
while ($rs-&gt;next())
{
  $record = $rs-&gt;getRow();
  $users[$record['ID'] = array('nickname'  =&gt; $record['NICKNAME'],
                               'firstname' =&gt; $record['FIRSTNAME'],
                               'lastname'  =&gt; $record['LASTNAME'],
                           );

  $level = $records['LEVEL'];
  $questions[$record['ID']][(($level &lt; 5) ? $level : 5)] = $record['NB_QUESTIONS'];
  $users[record['ID']]['questions']                      = $questions[$record['ID']];
}</code></pre>
<p>Pour ceux qui souhaitent mixer les deux méthodes, il est tout à fait possible de demander à un Criteria, de renvoyer un tableau indexé à partir
des noms de champs, ou des index numériques d'ailleurs.
Nous allons de la même façon que ci-dessus spécifier à Propel, la façon dont nous souhaitons récupérer nos résultats, pour le coup nous passerons
par la méthode</p>
<pre class="code-multiline"><code id="1122141f02687555b6c67fad295bb860">doSelectRS()</code></pre>
<p>afin de récupérer des resultSet et non des objets.</p>
<pre class="code-multiline language-php"><code class="language-php" id="d3129f1ee07a57942b09b0b020a73f22"><span class="token variable">$c</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Criteria</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token variable">$c</span><span class="token operator">-&gt;</span><span class="token function">clearSelectColumns</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$c</span><span class="token operator">-&gt;</span><span class="token function">addSelectColumn</span><span class="token punctuation">(</span><span class="token scope">UserPeer<span class="token punctuation">::</span></span><span class="token constant">NICKNAME</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$c</span><span class="token operator">-&gt;</span><span class="token function">addSelectColumn</span><span class="token punctuation">(</span><span class="token scope">QuestionPeer<span class="token punctuation">::</span></span><span class="token constant">ID</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$c</span><span class="token operator">-&gt;</span><span class="token function">addSelectColumn</span><span class="token punctuation">(</span><span class="token scope">QuestionPeer<span class="token punctuation">::</span></span><span class="token constant">BODY</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$c</span><span class="token operator">-&gt;</span><span class="token function">addSelectColumn</span><span class="token punctuation">(</span><span class="token scope">QuestionPeer<span class="token punctuation">::</span></span><span class="token constant">TITLE</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$c</span><span class="token operator">-&gt;</span><span class="token function">addSelectColumn</span><span class="token punctuation">(</span><span class="token scope">QuestionPeer<span class="token punctuation">::</span></span><span class="token constant">CREATED_AT</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$c</span><span class="token operator">-&gt;</span><span class="token function">addSelectColumn</span><span class="token punctuation">(</span><span class="token scope">QuestionPeer<span class="token punctuation">::</span></span><span class="token constant">LEVEL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$c</span><span class="token operator">-&gt;</span><span class="token function">addSelectColumn</span><span class="token punctuation">(</span><span class="token scope">QuestionPeer<span class="token punctuation">::</span></span><span class="token constant">INTERESTED_USERS</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$c</span><span class="token operator">-&gt;</span><span class="token function">addSelectColumn</span><span class="token punctuation">(</span><span class="token scope">QuestionPeer<span class="token punctuation">::</span></span><span class="token constant">NB_ANSWERS</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token variable">$c</span><span class="token operator">-&gt;</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token scope">QuestionPeer<span class="token punctuation">::</span></span><span class="token constant">IS_VALID</span><span class="token punctuation">,</span> <span class="token constant boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">empty</span><span class="token punctuation">(</span><span class="token variable">$filterDateFrom</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span>amp<span class="token punctuation">;</span><span class="token operator">&amp;</span>amp<span class="token punctuation">;</span> <span class="token operator">!</span><span class="token keyword">empty</span><span class="token punctuation">(</span><span class="token variable">$filterDateTo</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
  <span class="token variable">$c</span><span class="token operator">-&gt;</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token scope">QuestionPeer<span class="token punctuation">::</span></span><span class="token constant">CREATED_AT</span><span class="token punctuation">,</span> <span class="token scope">QuestionPeer<span class="token punctuation">::</span></span><span class="token constant">CREATED_AT</span><span class="token operator">.</span><span class="token string double-quoted-string">" BETWEEN '"</span><span class="token operator">.</span><span class="token variable">$filterDateFrom</span><span class="token operator">.</span><span class="token string double-quoted-string">"'AND '"</span><span class="token operator">.</span><span class="token variable">$filterDateTo</span><span class="token operator">.</span><span class="token string double-quoted-string">"'"</span><span class="token punctuation">,</span> <span class="token scope">Criteria<span class="token punctuation">::</span></span><span class="token constant">CUSTOM</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token variable">$rs</span> <span class="token operator">=</span> <span class="token scope">UserPeer<span class="token punctuation">::</span></span><span class="token function">doSelectRs</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$rs</span><span class="token operator">-&gt;</span><span class="token function">setFetchMode</span><span class="token punctuation">(</span><span class="token scope">ResultSet<span class="token punctuation">::</span></span><span class="token constant">FETCHMODE_ASSOC</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// PARSING</span>
<span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token variable">$rs</span><span class="token operator">-&gt;</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
  <span class="token variable">$records</span> <span class="token operator">=</span> <span class="token variable">$rs</span><span class="token operator">-&gt;</span><span class="token function">getRow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token variable">$results</span><span class="token punctuation">[</span><span class="token variable">$records</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'ID'</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span>
    <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'nickname'</span>            <span class="token operator">=&gt;</span> <span class="token variable">$records</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'NICKNAME'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
          <span class="token string single-quoted-string">'body'</span>                <span class="token operator">=&gt;</span> <span class="token variable">$records</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'BODY'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
          <span class="token string single-quoted-string">'title'</span>               <span class="token operator">=&gt;</span> <span class="token variable">$records</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'TITLE'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
          <span class="token string single-quoted-string">'created_at'</span>          <span class="token operator">=&gt;</span> <span class="token variable">$records</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'CREATED_AT'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
          <span class="token string single-quoted-string">'level'</span>               <span class="token operator">=&gt;</span> <span class="token variable">$records</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'LEVEL'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
          <span class="token string single-quoted-string">'interested_users'</span>    <span class="token operator">=&gt;</span> <span class="token variable">$records</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'INTERESTED_USERS'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
          <span class="token string single-quoted-string">'nb_answers'</span>          <span class="token operator">=&gt;</span> <span class="token variable">$records</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'NB_ANSWERS'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
          <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
                                                                </main>
            <aside class="article-content__aside">
                            </aside>
        </div>

        <div class="article-footer" data-aos="fade-in">
                                                <div class="article-author">
                        <div class="article-author__image">
                            <a href="/elao_/pr/636/blog/auteur/gfaivre">
                                <img     src="/elao_/pr/636/%2E%2E/../resized/content/images/members/avatars/gfaivre.jpg/0b15d32360625605c83c974bf168637b.jpg"
    srcset="
        /elao_/pr/636/%2E%2E/../resized/content/images/members/avatars/gfaivre.jpg/0b15d32360625605c83c974bf168637b.jpg 1x,
        /elao_/pr/636/%2E%2E/../resized/content/images/members/avatars/gfaivre.jpg/f804161347eed9c67c0f2c20a4f1fc65.jpg 2x
    "
 />
                            </a>
                        </div>
                        <span class="article-author__info">
                            Écrit par
                            <a href="/elao_/pr/636/blog/auteur/gfaivre">
                                <strong>Guewen Faivre</strong>
                            </a>
                        </span>

                        <div class="article-author__social">
                                                            <a href="https://twitter.com/guewen_faivre" class="social social--small">
                                    <i class="icon icon--x" aria-hidden="true"></i>
                                    <span class="screen-reader">Compte Twitter de Guewen Faivre</span>
                                </a>
                                                                                        <a href="https://github.com/gfaivre " class="social social--small">
                                    <i class="icon icon--github" aria-hidden="true"></i>
                                    <span class="screen-reader">Compte github de Guewen Faivre</span>
                                </a>
                                                                                        <a href="http://www.elao.com" class="social social--small">
                                    <i class="icon icon--website" aria-hidden="true"></i>
                                    <span class="screen-reader">Site personnel de Guewen Faivre</span>
                                </a>
                                                    </div>
                    </div>
                                    </div>

                <div class="bricks">
            
                            <div class="brick-contribute">
                    <p>
                        Une typo ?
                        <a href="https://github.com/Elao/elao_/edit/lazy/upgrade_to_php_83/content/blog/dev/propel-utiliser-des-champs-calcules.md/" target="_blank" class="animated-link animated-link--light">
                            Modifier cet article sur Github
                        </a>
                    </p>
                </div>
                    </div>
            </div>
        </main>
                    
<footer class="footer">
    <div class="container">
        <section class="footer__links">
            <p class="h1">
                elao
                <span>développe</span>
                <span>du lien</span>
            </p>
            <div class="links">
                                    <ul>
                                                    <li>
                                <a href="/elao_/pr/636/nos-services/" >Services</a>
                            </li>
                                                    <li>
                                <a href="/elao_/pr/636/demarche" >Démarche</a>
                            </li>
                                                    <li>
                                <a href="/elao_/pr/636/etudes-de-cas" >Études de cas</a>
                            </li>
                                            </ul>
                                    <ul>
                                                    <li>
                                <a href="/elao_/pr/636/nos-valeurs" >Valeurs</a>
                            </li>
                                                    <li>
                                <a href="/elao_/pr/636/equipe" >L&#039;équipe</a>
                            </li>
                                                    <li>
                                <a href="/elao_/pr/636/blog" >Blog</a>
                            </li>
                                                    <li>
                                <a href="/elao_/pr/636/blog/rss.xml"  data-no-swup="data-no-swup">RSS</a>
                            </li>
                                            </ul>
                                <ul>
                    <li>
                                                <a href="/elao_/pr/636/recrutement">
                            Nous recrutons
                                                            <span class="bullet">2</span>
                                                    </a>
                    </li>
                    <li>
                        <a href="/elao_/pr/636/glossaire/">Glossaire 🧐</a>
                    </li>
                    <li>
                        <a href="/elao_/pr/636/elaomojis">Elaomojis 🎉</a>
                    </li>
                </ul>
            </div>
            <div class="socials">
                <ul>
                    <li>
                        <a href="https://github.com/elao" target="_blank">
                            <i class="icon icon--github"></i>
                            Github
                        </a>
                    </li>
                    <li>
                        <a href="https://twitter.com/elao" target="_blank">
                            <i class="icon icon--x"></i>
                            Twitter
                        </a>
                    </li>
                    <li>
                        <a href="https://www.linkedin.com/company/elao/mycompany/" target="_blank">
                            <i class="icon icon--linkedin"></i>
                            Linkedin
                        </a>
                    </li>
                </ul>
            </div>
            <div class="contacts">
                <ul>
                    <li>
                        <a href="/elao_/pr/636/contact">Contact</a>
                    </li>
                    <li>
                        <a href="tel:04 82 53 37 19">04 82 53 37 19</a>
                    </li>
                    <li>
                        <a href="mailto:contact@elao.com">contact@elao.com</a>
                    </li>
                    <li>34 rue Jean Broquin</li>
                    <li>69006 Lyon</li>
                </ul>
            </div>
        </section>

        <section class="footer__legals">
            <span>© 2005 - 2024 - ELAO - Tous droits réservés</span>
            <a href="/elao_/pr/636/legal">Mentions légales</a>
            <a href="/elao_/pr/636/confidentialite">Protection des données</a>
            <a id="see" href="#ssss">🐍</a>
        </section>
    </div>
</footer>

            </body>
</html>
