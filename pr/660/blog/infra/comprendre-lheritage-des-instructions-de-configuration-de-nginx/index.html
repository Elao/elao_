<!DOCTYPE html>
<html lang="fr" class="no-js">
    <head>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>Comprendre l&#039;héritage des instructions de configuration de Nginx</title>

        <!-- Favicon -->
        <link rel="apple-touch-icon" sizes="180x180" href="/elao_/pr/660/apple-touch-icon.png">
        <link rel="icon" type="image/png" sizes="32x32" href="/elao_/pr/660/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/elao_/pr/660/favicon-16x16.png">
        <link rel="manifest" href="/elao_/pr/660/site.webmanifest">
        <link rel="mask-icon" href="/elao_/pr/660/safari-pinned-tab.svg" color="#ff4344">
        <link rel="shortcut icon" href="/elao_/pr/660/favicon.ico">
        <meta name="msapplication-TileColor" content="#ff4344">
        <meta name="msapplication-config" content="/elao_/pr/660/browserconfig.xml">
        <meta name="theme-color" content="#ffffff">

                    <meta name="description" content="Nginx fonctionne avec une notion de contexte autorisant certaines instructions de configuration. Nous évoquons dans cet article comment Nginx traite et organise ces différents blocs." />
            <link rel="canonical" href="https://elao.github.io/elao_/pr/660/blog/infra/comprendre-lheritage-des-instructions-de-configuration-de-nginx" />

            <!-- Open Graph / Facebook -->
            <meta property="og:title" content="Comprendre l&#039;héritage des instructions de configuration de Nginx" />
            <meta property="og:locale" content="fr" />
            <meta property="og:description" content="Nginx fonctionne avec une notion de contexte autorisant certaines instructions de configuration. Nous évoquons dans cet article comment Nginx traite et organise ces différents blocs." />
            <meta property="og:url" content="https://elao.github.io/elao_/pr/660/blog/infra/comprendre-lheritage-des-instructions-de-configuration-de-nginx" />
            <meta property="og:site_name" content="elao_" />

                                        <meta property="og:image" content="https://elao.github.io/elao_/pr/660/%2E%2E/../resized/content/images/blog/thumbnails/geek_love.jpg/cbd9134858efa352128a7d72a07bd976.jpg">
            
            <!-- Twitter -->
            <meta property="twitter:card" content="summary_large_image">
            <meta property="twitter:title" content="Comprendre l&#039;héritage des instructions de configuration de Nginx">
            <meta property="twitter:description" content="Nginx fonctionne avec une notion de contexte autorisant certaines instructions de configuration. Nous évoquons dans cet article comment Nginx traite et organise ces différents blocs.">
            <meta property="twitter:site" content="@elao">
            <meta property="twitter:creator" content="@elao">
                                        <meta property="twitter:image" content="https://elao.github.io/elao_/pr/660/%2E%2E/../resized/content/images/blog/thumbnails/geek_love.jpg/c954c6d2ef936becd40ba6ad4bc0ce1a.jpg">
                            <link rel="alternate" type="application/rss+xml" href="/elao_/pr/660/blog/rss.xml" title="Le blog de l'équipe d'Elao" />
        
                <script type="application/ld+json">{
    "@context": "https://schema.org",
    "@type": "NewsArticle",
    "headline": "Comprendre l'héritage des instructions de configuration de Nginx",
    "image": [
        "https://elao.github.io/elao_/pr/660/blog/infra/content/images/blog/thumbnails/geek_love.jpg"
    ],
    "datePublished": "2016-01-11T00:00:00+00:00",
    "dateModified": "2016-01-11T00:00:00+00:00",
    "author": [
        {
            "@type": "Person",
            "name": "Guewen Faivre",
            "url": "https://elao.github.io/elao_/pr/660/equipe/gfaivre"
        }
    ],
    "keywords": [
        "Infra",
        "Nginx",
        "Linux"
    ]
}
    </script>
    
                            <meta name="robots" content="noindex" />
        
        <script>
                        document.querySelector('html').classList.remove('no-js');
        </script>

                    <link rel="stylesheet" href="/elao_/pr/660/build/app.cc648c1f.css">
        
                        <script src="/elao_/pr/660/build/runtime.3c4e92bc.js" defer></script><script src="/elao_/pr/660/build/947.b56b79b1.js" defer></script><script src="/elao_/pr/660/build/769.7dfbbe52.js" defer></script><script src="/elao_/pr/660/build/app.e47fd89c.js" defer></script>

                    

    <script src="https://platform.twitter.com/widgets.js"></script>
    <script async defer src="//platform.instagram.com/en_US/embeds.js"></script>

    <script>
        window.onload = (function(){
            var tweets = document.querySelectorAll('.tweet-container');
            tweets.forEach(function(tweet) {
                // https://developer.twitter.com/en/docs/twitter-for-websites/embedded-tweets/guides/embedded-tweet-parameter-reference
                twttr.widgets.createTweet(tweet.getAttribute('data-tweet-id'), tweet, {
                    conversation: 'none',
                    cards: 'hidden',
                    theme: 'light',
                    lang: 'fr',
                    align: 'center',
                    width: 550, // default
                    dnt: true,
                })
            })
        });
    </script>

        <!-- S.E.E. -->
        <meta name="see" content="&#x5B;&quot;&#x5C;&#x2F;elao_&#x5C;&#x2F;pr&#x5C;&#x2F;660&#x5C;&#x2F;build&#x5C;&#x2F;see.80fe75b7.js&quot;&#x5D;">
        <meta name="see_style" content="&#x5B;&quot;&#x5C;&#x2F;elao_&#x5C;&#x2F;pr&#x5C;&#x2F;660&#x5C;&#x2F;build&#x5C;&#x2F;see.d77e78f8.css&quot;&#x5D;">
    </head>
    <body
        data-controller="swup-plugins symfony--ux-swup--swup swup-matomo" data-symfony--ux-swup--swup-containers-value="&#x5B;&quot;&#x23;main&quot;,&quot;&#x23;nav&quot;&#x5D;" data-symfony--ux-swup--swup-cache-value="true" data-symfony--ux-swup--swup-animate-history-browsing-value="true" data-symfony--ux-swup--swup-debug-value="false" data-symfony--ux-swup--swup-link-selector-value="a&#x5B;href&#x5E;&#x3D;&quot;https&#x3A;&#x2F;&#x2F;elao.github.io&#x2F;elao_&#x2F;pr&#x2F;660&quot;&#x5D;&#x3A;not&#x28;&#x5B;data-no-swup&#x5D;&#x29;&#x3A;not&#x28;&#x5B;target&#x3D;&quot;_blank&quot;&#x5D;&#x29;&#x3A;not&#x28;a&#x5B;href&#x5E;&#x3D;&quot;https&#x3A;&#x2F;&#x2F;elao.github.io&#x2F;elao_&#x2F;pr&#x2F;660&#x2F;_profiler&quot;&#x5D;&#x29;,a&#x5B;href&#x5E;&#x3D;&quot;&#x2F;&quot;&#x5D;&#x3A;not&#x28;&#x5B;data-no-swup&#x5D;&#x29;&#x3A;not&#x28;&#x5B;target&#x3D;&quot;_blank&quot;&#x5D;&#x29;&#x3A;not&#x28;a&#x5B;href&#x5E;&#x3D;&quot;https&#x3A;&#x2F;&#x2F;elao.github.io&#x2F;elao_&#x2F;pr&#x2F;660&#x2F;_profiler&quot;&#x5D;&#x29;" data-swup-matomo-enabled-value="false">
                    <header id="nav" class="header">
                <div class="container">
                    <!--
                        Todo :
                        - only on homepage : on scroll .logo.logo--animated becomes .logo.logo--animated.logo--active (triggers its animation)
                     -->
                    <a href="/elao_/pr/660/">
                        <span class="screen-reader">Comprendre l&#039;héritage des instructions de configuration de Nginx</span>
                                                    <svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" viewBox="0 0 300 100" class="logo logo--animated">
                                <path d="M61.6,61.6H19.7C21,69,24.8,72.2,32.6,72.2c5.9,0,8.8-1.9,11.7-7.8l16.1,6.9C56.2,82,46.9,87.8,32.1,87.8
                                    c-19.1,0-32-12.6-32-31.6c0-19.5,12.6-32.6,31.4-32.6c18.1,0,30.3,12.6,30.3,31.6C61.7,57.2,61.7,58.9,61.6,61.6z M19.6,49.3h23.6
                                    c-0.2-7.9-4.1-10.9-11.3-10.9S20.7,41.8,19.6,49.3z"/>
                                <path d="M71.2,0.1H90v86.5H71.2V0.1z"/>
                                <path d="M166.1,24.7v61.8h-18.8V72.7c-3.5,9.8-10.5,15.1-20.4,15.1c-17.7,0-27.4-12.9-27.4-32
                                    c0-19.4,9.3-32.2,26.2-32.2c10.5,0,18,5.4,21.6,15.6V24.7H166.1z M147.9,55.7c0-10.4-4.8-15.2-15.1-15.2c-9.9,0-14.6,4.8-14.6,15.2
                                    c0,10.1,4.7,14.9,14.6,14.9C143.1,70.7,147.9,65.9,147.9,55.7L147.9,55.7z"/>
                                <path d="M242.8,55.8c0,19.9-15.3,32-33.6,32s-33.6-12.1-33.6-32s15.3-32.2,33.6-32.2S242.8,35.8,242.8,55.8z M224,55.8
                                    c0-10.4-4.7-15.2-14.8-15.2c-10.1,0-14.8,4.8-14.8,15.2c0,10.1,4.7,14.9,14.8,14.9S224,65.9,224,55.8L224,55.8z"/>
                                <rect x="243.1" y="86.5" width="56.7" height="15"/>
                            </svg>
                                            </a>

                                            <!-- Desktop nav -->
                        <nav class="nav">
                            <ul>
                                                                    <li class="nav__item ">
                                        <a href="/elao_/pr/660/nos-services/">
                                                                                        <span>Services</span>
                                        </a>
                                    </li>
                                                                    <li class="nav__item ">
                                        <a href="/elao_/pr/660/demarche">
                                                                                        <span>Démarche</span>
                                        </a>
                                    </li>
                                                                    <li class="nav__item ">
                                        <a href="/elao_/pr/660/etudes-de-cas">
                                                                                        <span>Études de cas</span>
                                        </a>
                                    </li>
                                                                    <li class="nav__item ">
                                        <a href="/elao_/pr/660/nos-valeurs">
                                                                                        <span>Valeurs</span>
                                        </a>
                                    </li>
                                                                    <li class="nav__item ">
                                        <a href="/elao_/pr/660/equipe">
                                                                                        <span>L&#039;équipe</span>
                                        </a>
                                    </li>
                                                                    <li class="nav__item nav__item--active">
                                        <a href="/elao_/pr/660/blog">
                                                                                        <span>Blog</span>
                                        </a>
                                    </li>
                                                                    <li class="nav__item ">
                                        <a href="/elao_/pr/660/contact">
                                                                                            <i class="icon icon--contact" aria-hidden="true"></i>
                                                                                        <span>Contact</span>
                                        </a>
                                    </li>
                                                            </ul>
                        </nav>
                    
                                            <!-- Mobile nav -->
                        <nav class="nav-mobile" data-controller="toggle">
                            <div class="nav-mobile__header">
                                <a href="/elao_/pr/660/">
                                                                <svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" viewBox="0 0 300 100" class="logo logo--animated">
                                <path d="M61.6,61.6H19.7C21,69,24.8,72.2,32.6,72.2c5.9,0,8.8-1.9,11.7-7.8l16.1,6.9C56.2,82,46.9,87.8,32.1,87.8
                                    c-19.1,0-32-12.6-32-31.6c0-19.5,12.6-32.6,31.4-32.6c18.1,0,30.3,12.6,30.3,31.6C61.7,57.2,61.7,58.9,61.6,61.6z M19.6,49.3h23.6
                                    c-0.2-7.9-4.1-10.9-11.3-10.9S20.7,41.8,19.6,49.3z"/>
                                <path d="M71.2,0.1H90v86.5H71.2V0.1z"/>
                                <path d="M166.1,24.7v61.8h-18.8V72.7c-3.5,9.8-10.5,15.1-20.4,15.1c-17.7,0-27.4-12.9-27.4-32
                                    c0-19.4,9.3-32.2,26.2-32.2c10.5,0,18,5.4,21.6,15.6V24.7H166.1z M147.9,55.7c0-10.4-4.8-15.2-15.1-15.2c-9.9,0-14.6,4.8-14.6,15.2
                                    c0,10.1,4.7,14.9,14.6,14.9C143.1,70.7,147.9,65.9,147.9,55.7L147.9,55.7z"/>
                                <path d="M242.8,55.8c0,19.9-15.3,32-33.6,32s-33.6-12.1-33.6-32s15.3-32.2,33.6-32.2S242.8,35.8,242.8,55.8z M224,55.8
                                    c0-10.4-4.7-15.2-14.8-15.2c-10.1,0-14.8,4.8-14.8,15.2c0,10.1,4.7,14.9,14.8,14.9S224,65.9,224,55.8L224,55.8z"/>
                                <rect x="243.1" y="86.5" width="56.7" height="15"/>
                            </svg>
                        
                                </a>
                                <button class="nav-toggle nav-toggle--close">
                                    <i class="icon icon--close" aria-hidden="true"></i>
                                    <span class="screen-reader">Fermer le menu</span>
                                </button>
                            </div>
                            <ul>
                                                                    <li class="nav-mobile__item  ">
                                        <a href="/elao_/pr/660/nos-services/">
                                                                                        <span>Services</span>
                                        </a>
                                    </li>
                                                                    <li class="nav-mobile__item  ">
                                        <a href="/elao_/pr/660/demarche">
                                                                                        <span>Démarche</span>
                                        </a>
                                    </li>
                                                                    <li class="nav-mobile__item  ">
                                        <a href="/elao_/pr/660/etudes-de-cas">
                                                                                        <span>Études de cas</span>
                                        </a>
                                    </li>
                                                                    <li class="nav-mobile__item  ">
                                        <a href="/elao_/pr/660/nos-valeurs">
                                                                                        <span>Valeurs</span>
                                        </a>
                                    </li>
                                                                    <li class="nav-mobile__item  ">
                                        <a href="/elao_/pr/660/equipe">
                                                                                        <span>L&#039;équipe</span>
                                        </a>
                                    </li>
                                                                    <li class="nav-mobile__item nav-mobile__item--active ">
                                        <a href="/elao_/pr/660/blog">
                                                                                        <span>Blog</span>
                                        </a>
                                    </li>
                                                                    <li class="nav-mobile__item  nav-mobile__item--large">
                                        <a href="/elao_/pr/660/contact">
                                                                                            <i class="icon icon--contact" aria-hidden="true"></i>
                                                                                        <span>Contact</span>
                                        </a>
                                    </li>
                                                            </ul>
                        </nav>
                        <button class="nav-toggle nav-toggle--open">
                            <i class="icon icon--hamburger" aria-hidden="true"></i>
                            <span class="screen-reader">Ouvrir le menu</span>
                        </button>
                                    </div>
            </header>
                <main id="main">
                <div class="container">
                                <ol class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList">
            <li class="breadcrumb__item" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
            <a itemprop="item" href="/elao_/pr/660/">
                <span itemprop="name">Accueil</span>
            </a>
            <meta itemprop="position" content="1" />
        </li>        <li class="breadcrumb__item" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
            <a itemprop="item" href="/elao_/pr/660/blog">
                <span itemprop="name">Blog</span>
            </a>
            <meta itemprop="position" content="2" />
        </li>        <li class="breadcrumb__item" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
            <a itemprop="item" href="/elao_/pr/660/blog/infra">
                <span itemprop="name">Infra</span>
            </a>
            <meta itemprop="position" content="3" />
        </li>        <li class="breadcrumb__item" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
            <a itemprop="item" href="#">
                <span itemprop="name">Comprendre l&#039;héritage des instructions de configuration de Nginx</span>
            </a>
            <meta itemprop="position" content="4" />
        </li></ol>

        
        <div class="article-banner">
            <div
                class="article-banner__cover"
                style="background: #f1f1f1 url('/elao_/pr/660/%2E%2E/../resized/content/images/blog/headers/stickers.jpg/c8e4db7078e778f2b5b30f1dae8445bf.jpg');
    background: #f1f1f1 -webkit-image-set(
        url('/elao_/pr/660/%2E%2E/../resized/content/images/blog/headers/stickers.jpg/c8e4db7078e778f2b5b30f1dae8445bf.jpg') 1x,
        url('/elao_/pr/660/%2E%2E/../resized/content/images/blog/headers/stickers.jpg/002e20bfb1d28d581bdccc477eb903b8.jpg') 2x
    );
    background: #f1f1f1 -moz-image-set(
        url('/elao_/pr/660/%2E%2E/../resized/content/images/blog/headers/stickers.jpg/c8e4db7078e778f2b5b30f1dae8445bf.jpg') 1x,
        url('/elao_/pr/660/%2E%2E/../resized/content/images/blog/headers/stickers.jpg/002e20bfb1d28d581bdccc477eb903b8.jpg') 2x
    );
    background: #f1f1f1 -ms-image-set(
        url('/elao_/pr/660/%2E%2E/../resized/content/images/blog/headers/stickers.jpg/c8e4db7078e778f2b5b30f1dae8445bf.jpg') 1x,
        url('/elao_/pr/660/%2E%2E/../resized/content/images/blog/headers/stickers.jpg/002e20bfb1d28d581bdccc477eb903b8.jpg') 2x
    );
    background: #f1f1f1 image-set(
        url('/elao_/pr/660/%2E%2E/../resized/content/images/blog/headers/stickers.jpg/c8e4db7078e778f2b5b30f1dae8445bf.jpg') 1x,
        url('/elao_/pr/660/%2E%2E/../resized/content/images/blog/headers/stickers.jpg/002e20bfb1d28d581bdccc477eb903b8.jpg') 2x
    );"
                data-aos="fade-down"
            ></div>

            <div class="article-info" data-aos="zoom-in">
                                                    <div class="article-author ">
                        <div class="article-author__image">
                                                            <a href="/elao_/pr/660/blog/auteur/gfaivre">
                                    <img     src="/elao_/pr/660/%2E%2E/../resized/content/images/members/avatars/gfaivre.jpg/0b15d32360625605c83c974bf168637b.jpg"
    srcset="
        /elao_/pr/660/%2E%2E/../resized/content/images/members/avatars/gfaivre.jpg/0b15d32360625605c83c974bf168637b.jpg 1x,
        /elao_/pr/660/%2E%2E/../resized/content/images/members/avatars/gfaivre.jpg/f804161347eed9c67c0f2c20a4f1fc65.jpg 2x
    "
 />
                                </a>
                                                    </div>
                        <span class="article-author__info">
                            Écrit par
                                                            <a href="/elao_/pr/660/blog/auteur/gfaivre">
                                    <strong>Guewen Faivre</strong>
                                </a>
                                                    </span>
                    </div>
                                <div class="article-info__date">
                    <span>Publication <strong>11 janvier 2016</strong></span>
                                                        </div>
            </div>

            <div class="article-header" data-aos="zoom-in-up">
                <h1>Comprendre l&#039;héritage des instructions de configuration de Nginx</h1>
                <p>Nginx fonctionne avec une notion de contexte autorisant certaines instructions de configuration. Nous évoquons dans cet article comment Nginx traite et organise ces différents blocs.</p>
                <ul class="article-tag-list">
                                            <li class="article-tag-list__item">
                            <a href="/elao_/pr/660/blog/tag/infra" rel="nofollow">#Infra</a>
                        </li>
                                            <li class="article-tag-list__item">
                            <a href="/elao_/pr/660/blog/tag/nginx" rel="nofollow">#Nginx</a>
                        </li>
                                            <li class="article-tag-list__item">
                            <a href="/elao_/pr/660/blog/tag/linux" rel="nofollow">#Linux</a>
                        </li>
                                    </ul>
            </div>
        </div>

                    <ol class="table-of-content" data-aos="fade-up">
                                    <li class="table-of-content__item">
                        <a href="#exemple">Exemple:</a>

                                            </li>
                                    <li class="table-of-content__item">
                        <a href="#a-l-interieur-d-un-meme-contexte">A l&#039;intérieur d&#039;un même contexte</a>

                                            </li>
                                    <li class="table-of-content__item">
                        <a href="#a-l-interieur-de-contextes-differents">A l&#039;intérieur de contextes différents</a>

                                            </li>
                            </ol>
        
        <div class="article-content">
            <main class="article-content__main">

                
                
                <p>Nginx fonctionne sur la base de blocs de configuration appelés « Contexte de configuration », qui vont selon leur positionnement et/ou leurs instructions traiter, modifier voir altérer les requêtes entrantes.<!--more--></p>
<h1 id="les-contextes" class="anchor-title"><a href="#les-contextes">Les contextes</a></h1>
<p>L'organisation des contextes est primordiale car leur positionnement dans la configuration n'est pas sans importance et s'apparente à un arbre.</p>
<pre class="code-multiline language-bash"><code class="language-bash" id="d2c3b88f1688f05df253a5dabfd29a51">Global <span class="token punctuation">(</span>ou Main<span class="token punctuation">)</span>
├── Events
└── Http
    ├── Server
    ├── If
    ├── Location
    │   ├── If
    │   ├── Location <span class="token punctuation">(</span>Imbriquée<span class="token punctuation">)</span>
    │   └── limit_except
    ├── map
    ├── perl / <span class="token punctuation">(</span>perl_set<span class="token punctuation">)</span>
    ├── split_clients
    ├── geo
    ├── types
    └── charset_map</code></pre>
<blockquote>
<p><strong>N.B.:</strong> Le contexte <strong>global</strong> est particulier car non-défini explicitement. Toute directive spécifiée hors d'un contexte est considérée comme appartenant au contexte <strong>global</strong>.</p>
</blockquote>
<h3 id="exemple" class="anchor-title"><a href="#exemple">Exemple</a></h3>
<pre class="code-multiline language-nginx"><code class="language-nginx" id="2ea402a233cb394bb023721a569531a8"><span class="token directive"><span class="token keyword">user</span> www-data</span><span class="token punctuation">;</span>
<span class="token directive"><span class="token keyword">worker_processes</span> <span class="token number">1</span></span><span class="token punctuation">;</span>

<span class="token directive"><span class="token keyword">error_log</span> /var/log/nginx/error.log warn</span><span class="token punctuation">;</span>
<span class="token directive"><span class="token keyword">pid</span> /var/run/nginx.pid</span><span class="token punctuation">;</span>

<span class="token directive"><span class="token keyword">events</span></span> <span class="token punctuation">{</span>
    <span class="token directive"><span class="token keyword">worker_connections</span> <span class="token number">1024</span></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
<h1 id="les-directives-de-type-chaine" class="anchor-title"><a href="#les-directives-de-type-chaine">Les directives de type chaîne</a></h1>
<p>Il est très important de garder à l'esprit que les directives de configuration s'appliquent <strong>toujours</strong> vers le bas, il n'y a aucune chance qu'une directive ait un impact sur une directive de plus haut ou de même niveau.
Même lorsqu'une directive <code class="code-inline" id="d5189de027922f81005951e6efe0efd5">location</code> renvoie vers une directive identique le contexte de la première n'a <strong>plus aucune valeur</strong>.</p>
<p>A l'inverse les contextes pouvant être imbriqués les uns dans les autres, Nginx considère également l'héritage des directives de configuration, la règle étant que si une directive est valide dans deux contextes imbriqués, une directive déclarée dans un contexte parent s'appliquera à ses enfants comme valeur par défaut.</p>
<p><strong>Le contexte enfant pouvant, bien entendu, surcharger ces directives.</strong></p>
<h2 id="exemple" class="anchor-title"><a href="#exemple">Exemple:</a></h2>
<pre class="code-multiline language-nginx"><code class="language-nginx" id="ce3318e6430a1d28afad545e05d58983"><span class="token directive"><span class="token keyword">server</span></span> <span class="token punctuation">{</span>
    <span class="token directive"><span class="token keyword">root</span> /srv/app/symfony/web</span><span class="token punctuation">;</span>

    <span class="token directive"><span class="token keyword">location</span> /app</span> <span class="token punctuation">{</span>
        <span class="token directive"><span class="token keyword">root</span> /usr/share</span><span class="token punctuation">;</span> <span class="token comment"># Nous modifions le répertoire racine vers /usr/share/app</span>
                         <span class="token comment"># Toutes les URI de type /app/* seront servies</span>
                         <span class="token comment"># à partir de ce répertoire.</span>
    <span class="token punctuation">}</span>

    <span class="token directive"><span class="token keyword">location</span> /app2</span> <span class="token punctuation">{</span>
        <span class="token comment"># La directive root du contexte "Server" s'applique</span>
        <span class="token comment"># Une URI de type /app2/user/profil sera servie</span>
        <span class="token comment"># à partir de /srv/app/symfony/web</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
<h1 id="les-directives-de-type-tableau" class="anchor-title"><a href="#les-directives-de-type-tableau">Les directives de type tableau</a></h1>
<p>Les directives <code class="code-inline" id="bb54288caaecd39acee15e7ab82daa04">array-type</code> n'échappent pas à la règle de surcharge, cependant leur comportement est légèrement différent, deux cas de figure peuvent se présenter.</p>
<blockquote>
<p>Pour rappel un <code class="code-inline" id="bb54288caaecd39acee15e7ab82daa04">array-type</code> est un type de données utilisé pour décrire une collection d'éléments identifiés unitairement par une clé, <strong>ils sont compilés au lancement du programme</strong>.</p>
</blockquote>
<h2 id="a-l-interieur-d-un-meme-contexte" class="anchor-title"><a href="#a-l-interieur-d-un-meme-contexte">A l'intérieur d'un même contexte</a></h2>
<p>La redéfinition d'une directive array-type à l'intérieur d'un même bloc, par exemple un bloc <code class="code-inline" id="d5189de027922f81005951e6efe0efd5">location</code>, entraine l'ajout de la nouvelle clé à la structure.</p>
<h3 id="exemple" class="anchor-title"><a href="#exemple">Exemple</a></h3>
<pre class="code-multiline language-nginx"><code class="language-nginx" id="09af2b6ecfe2636d0501e469a3939f31"><span class="token directive"><span class="token keyword">fastcgi_param</span> SCRIPT_FILENAME <span class="token variable">$document_root</span><span class="token variable">$fastcgi_script_name</span></span><span class="token punctuation">;</span>
<span class="token directive"><span class="token keyword">fastcgi_param</span> HTTPS <span class="token boolean">off</span></span><span class="token punctuation">;</span></code></pre>
<p>Dans ce cas la directive <code class="code-inline" id="78ba1199d4698c55f33d27103f2ce07d">fastcgi_param</code> contient les données suivantes:</p>
<pre class="code-multiline language-yaml"><code class="language-yaml" id="e246bc7375cca80278484310647a481b"><span class="token key atrule">fastcgi_param</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">SCRIPT_FILENAME</span><span class="token punctuation">:</span> $document_root$fastcgi_script_name
    <span class="token punctuation">-</span> <span class="token key atrule">HTTPS</span><span class="token punctuation">:</span> off</code></pre>
<h2 id="a-l-interieur-de-contextes-differents" class="anchor-title"><a href="#a-l-interieur-de-contextes-differents">A l'intérieur de contextes différents</a></h2>
<p>Dans ce cas le comportement sera le même qu'une <strong>surcharge de directive</strong>, la nouvelle définition écrasant la précédente, il ne faut donc pas considérer que l'on ajoute une nouvelle clé à un tableau existant car n'oubliez pas, les directives n'ont d'existence que dans <strong>le contexte auquel elles appartiennent</strong>.
Ce comportement justifie souvent d'avoir une même configuration qui se répête dans deux blocs différents alors qu'une seule clé est modifiée.</p>
<h3 id="exemple" class="anchor-title"><a href="#exemple">Exemple</a></h3>
<pre class="code-multiline language-nginx"><code class="language-nginx" id="3db0a95767729ed846d8fe590a33e8ea"><span class="token directive"><span class="token keyword">location</span> ~ ^/(frontend)\.php(/|$)</span> <span class="token punctuation">{</span>
        <span class="token directive"><span class="token keyword">include</span> conf.d/php_fpm_params</span><span class="token punctuation">;</span>
        <span class="token directive"><span class="token keyword">fastcgi_param</span> SCRIPT_FILENAME <span class="token variable">$document_root</span><span class="token variable">$fastcgi_script_name</span></span><span class="token punctuation">;</span>
        <span class="token directive"><span class="token keyword">fastcgi_param</span> HTTPS <span class="token boolean">on</span></span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token directive"><span class="token keyword">location</span> ~ ^/(backend)\.php(/|$)</span> <span class="token punctuation">{</span>
        <span class="token directive"><span class="token keyword">include</span> conf.d/php_fpm_params</span><span class="token punctuation">;</span>
        <span class="token directive"><span class="token keyword">fastcgi_param</span> SCRIPT_FILENAME <span class="token variable">$document_root</span><span class="token variable">$fastcgi_script_name</span></span><span class="token punctuation">;</span>
        <span class="token directive"><span class="token keyword">fastcgi_param</span> HTTPS <span class="token boolean">off</span></span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span></code></pre>
<blockquote>
<p>ATTENTION: certaines directives sont propres à un contexte et ne peuvent donc pas être utilisées hors de celui-ci.</p>
</blockquote>
<h1 id="les-directives-de-type-action" class="anchor-title"><a href="#les-directives-de-type-action">Les directives de type action</a></h1>
<p>Les directives de type action ont la particularité de ne pas impacter leur comportement les unes entre les autres, elles sont en effet limités à un seul contexte et ne sont pas concernées par l'héritage descendant.
Elles peuvent toutefois, être utilisées dans plusieurs contextes et être exécutées pour chacun d'entre eux.</p>
<p>La directive <code class="code-inline" id="7b4639e8d528d7a3eedafe23e9cdfee1">rewrite</code> est un bon exemple car elle peut être utilisée à la fois dans le contexte <code class="code-inline" id="cf1e8c14e54505f60aa10ceb8d5d8ab3">server</code> et dans le contexte <code class="code-inline" id="d5189de027922f81005951e6efe0efd5">location</code> et être exécutée dans les deux.</p>
<h3 id="exemple" class="anchor-title"><a href="#exemple">Exemple</a></h3>
<pre class="code-multiline language-nginx"><code class="language-nginx" id="c94c129a971b431f971cbca05a8089e8"><span class="token directive"><span class="token keyword">server</span></span> <span class="token punctuation">{</span>
    <span class="token directive"><span class="token keyword">rewrite</span> ^/elao-lyon(.*) /lyon<span class="token variable">$1</span> permanent</span><span class="token punctuation">;</span> <span class="token comment"># Cette règle est toujours évaluée.</span>

    <span class="token directive"><span class="token keyword">location</span> /lyon</span> <span class="token punctuation">{</span>
        <span class="token directive"><span class="token keyword">rewrite</span> ^ /index.php</span><span class="token punctuation">;</span> <span class="token comment"># Ne surcharge pas la précédente et</span>
                              <span class="token comment"># PEUT être évaluée en complément de la précédente.</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
                                                                </main>
            <aside class="article-content__aside">
                            </aside>
        </div>

        <div class="article-footer" data-aos="fade-in">
                                                <div class="article-author">
                        <div class="article-author__image">
                            <a href="/elao_/pr/660/blog/auteur/gfaivre">
                                <img     src="/elao_/pr/660/%2E%2E/../resized/content/images/members/avatars/gfaivre.jpg/0b15d32360625605c83c974bf168637b.jpg"
    srcset="
        /elao_/pr/660/%2E%2E/../resized/content/images/members/avatars/gfaivre.jpg/0b15d32360625605c83c974bf168637b.jpg 1x,
        /elao_/pr/660/%2E%2E/../resized/content/images/members/avatars/gfaivre.jpg/f804161347eed9c67c0f2c20a4f1fc65.jpg 2x
    "
 />
                            </a>
                        </div>
                        <span class="article-author__info">
                            Écrit par
                            <a href="/elao_/pr/660/blog/auteur/gfaivre">
                                <strong>Guewen Faivre</strong>
                            </a>
                        </span>

                        <div class="article-author__social">
                                                            <a
                                    href="https://twitter.com/guewen_faivre"
                                    target="_blank"
                                    rel="noreferrer"
                                    class="social social--small"
                                >
                                    <i class="icon icon--x" aria-hidden="true"></i>
                                    <span class="screen-reader">Compte Twitter de Guewen Faivre</span>
                                </a>
                                                                                                                    <a
                                    href="https://github.com/gfaivre"
                                    target="_blank"
                                    rel="noreferrer"
                                    class="social social--small"
                                >
                                    <i class="icon icon--github" aria-hidden="true"></i>
                                    <span class="screen-reader">Compte github de Guewen Faivre</span>
                                </a>
                                                                                        <a href="http://www.elao.com"
                                    target="_blank"
                                    rel="noreferrer"
                                    class="social social--small"
                                >
                                    <i class="icon icon--website" aria-hidden="true"></i>
                                    <span class="screen-reader">Site personnel de Guewen Faivre</span>
                                </a>
                                                    </div>
                    </div>
                                    </div>

                <div class="bricks">
            
                            <div class="brick-contribute">
                    <p>
                        Une typo ?
                        <a href="https://github.com/Elao/elao_/edit/feature/add-carriere-page/content/blog/infra/comprendre-lheritage-des-instructions-de-configuration-de-nginx.md/" target="_blank" class="animated-link animated-link--light">
                            Modifier cet article sur Github
                        </a>
                    </p>
                </div>
                    </div>
            </div>
        </main>
                    
<footer class="footer">
    <div class="container">
        <section class="footer__links">
            <p class="h1">
                elao
                <span>développe</span>
                <span>du lien</span>
            </p>
            <div class="links">
                                    <ul>
                                                    <li>
                                <a href="/elao_/pr/660/nos-services/" >Services</a>
                            </li>
                                                    <li>
                                <a href="/elao_/pr/660/demarche" >Démarche</a>
                            </li>
                                                    <li>
                                <a href="/elao_/pr/660/etudes-de-cas" >Études de cas</a>
                            </li>
                                            </ul>
                                    <ul>
                                                    <li>
                                <a href="/elao_/pr/660/nos-valeurs" >Valeurs</a>
                            </li>
                                                    <li>
                                <a href="/elao_/pr/660/equipe" >L&#039;équipe</a>
                            </li>
                                                    <li>
                                <a href="/elao_/pr/660/blog" >Blog</a>
                            </li>
                                                    <li>
                                <a href="/elao_/pr/660/blog/rss.xml"  data-no-swup="data-no-swup">RSS</a>
                            </li>
                                            </ul>
                                <ul>
                    <li>
                        <a href="/elao_/pr/660/carriere">Page Carrière</a>
                    </li>
                    <li>
                        <a href="/elao_/pr/660/glossaire/">Glossaire 🧐</a>
                    </li>
                    <li>
                        <a href="/elao_/pr/660/elaomojis">Elaomojis 🎉</a>
                    </li>
                </ul>
            </div>
            <div class="socials">
                <ul>
                    <li>
                        <a href="https://www.linkedin.com/company/elao/" target="_blank">
                            <i class="icon icon--linkedin"></i>
                            Linkedin
                        </a>
                    </li>
                    <li>
                        <a href="https://bsky.app/profile/elao.com" target="_blank">
                            <i class="icon icon--bluesky"></i>
                            Bluesky
                        </a>
                    </li>
                    <li>
                        <a href="https://twitter.com/elao" target="_blank">
                            <i class="icon icon--x"></i>
                            X
                        </a>
                    </li>
                    <li>
                        <a href="https://github.com/elao" target="_blank">
                            <i class="icon icon--github"></i>
                            Github
                        </a>
                    </li>
                </ul>
            </div>
            <div class="contacts">
                <ul>
                    <li>
                        <a href="/elao_/pr/660/contact">Contact</a>
                    </li>
                    <li>
                        <a href="tel:04 82 53 37 19">04 82 53 37 19</a>
                    </li>
                    <li>
                        <a href="mailto:contact@elao.com">contact@elao.com</a>
                    </li>
                    <li>34 rue Jean Broquin</li>
                    <li>69006 Lyon</li>
                </ul>
            </div>
        </section>

        <section class="footer__legals">
            <span>© 2005 - 2025 - ELAO - Tous droits réservés</span>
            <a href="/elao_/pr/660/legal">Mentions légales</a>
            <a href="/elao_/pr/660/confidentialite">Protection des données</a>
            <a id="see" href="#ssss">🐍</a>
        </section>
    </div>
</footer>

            </body>
</html>
