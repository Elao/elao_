{% import "macros.html.twig" as macros %}
{% extends 'base.html.twig' %}

{% block meta_title config.title %}
{% block meta_description config.description %}

{% block twitter_card_type 'summary_large_image' %}
{% block og_image absolute_url(asset(config.ogImage|glide_image_preset('opengraph_image'))) %}
{% block twitter_image absolute_url(asset(config.twitterImage|glide_image_preset('twitter_card'))) %}
{% set routes = [{path: path('homepage'), label: 'Accueil'}, {path: '#', label: 'Elaomojis'}] %}

{% block content %}
    <div class="container">
        {{ macros.breadcrumb(routes) }}

        <div class="banner">
            <h1 class="banner__title" data-aos="fade-right">
                S√©lection officielle
                <span>de nos Elaomojis ü•Åü•Åü•Å</span>
            </h1>
            <div class="banner__highlight" data-aos="zoom-in">
                <p>√Ä l‚Äôoccasion de la Journ√©e Mondiale des Emojis 2021 (World Emoji Day), nous sommes ravis de vous pr√©senter une s√©lection de nos :emojis-favoris:</p>
            </div>
        </div>

        {% for category in config.categories %}
            <h2>{{ category.title }}</h2>
            {% for section in category.sections %}
                <h3>{{ section.title }}</h3>
                <ul class="elaomojis">
                    {% for emoji in section.emojis %}
                        <li class="elaomojis__item" aria-hidden="true">
                            <a href="{{ asset('build/images/elaomojis/%s'|format(emoji.path)) }}" target="_blank">
                                <span class="img" style="background: url('{{ asset('build/images/elaomojis/%s'|format(emoji.path)) }}')"></span>
                                {{ emoji.code }}
                            </a>
                        </li>
                    {% endfor %}
                </ul>
            {% endfor %}
        {% endfor %}

        {# TODO : set tweet ID in elaomojis.config.json once tweeted üê¶ #}
        {% if config.tweetId is not empty %}
            <div class="bricks">
                <div class="brick-comment">
                    <p class="title">Et vous ?</p>
                    <p>
                        Quels sont vos emojis pr√©f√©r√©s ?
                        <a href="{{ external_url('twitter_like', { tweet_id: config.tweetId }) }}" target="_blank" class="animated-link animated-link--light">
                            Poursuivons la discussion sur twitter !
                        </a>
                    </p>
                    <div id="tweet-container" class="tweet-container" data-tweet-id="{{ config.tweetId }}"></div>
                </div>
            </div>
        {% endif %}
    </div>
{% endblock %}

{% block javascripts %}
    {{ parent() }}

    <script src="https://platform.twitter.com/widgets.js"></script>
    <script>
        window.onload = (function(){
            var tweet = document.getElementById('tweet-container');
            // https://developer.twitter.com/en/docs/twitter-for-websites/embedded-tweets/guides/embedded-tweet-parameter-reference
            twttr.widgets.createTweet(tweet.getAttribute('data-tweet-id'), tweet, {
                conversation: 'none',
                cards: 'hidden',
                theme: 'light',
                lang: 'fr',
                align: 'center',
                width: 550, // default
                dnt: true,
            })
        });
    </script>
{% endblock %}
